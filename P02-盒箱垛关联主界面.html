<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=1366">
<title>ç›’ç®±å›å…³è”é‡‡é›†ç³»ç»Ÿ - 2å·æœº</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', 'Segoe UI', sans-serif;
  background: #E9EEF5;
  width: 1366px;
  height: 768px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  font-size: 14px;
  color: #1F2937;
}

/* ==================== èœå•æ  ==================== */
.menu-bar {
  height: 32px;
  background: #fff;
  border-bottom: 1px solid #e0e0e0;
  display: flex;
  align-items: center;
  padding: 0 16px;
  gap: 24px;
  flex-shrink: 0;
  position: relative;
  z-index: 200;
}
.menu-item {
  font-size: 14px;
  color: #333;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  user-select: none;
  position: relative;
}
.menu-item:hover { background: #f0f4ff; }
.menu-dropdown {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  background: #fff;
  border: 1px solid #d0d0d0;
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.12);
  min-width: 140px;
  z-index: 1000;
}
.menu-item:hover .menu-dropdown { display: block; }
.menu-dropdown-item {
  padding: 8px 16px;
  font-size: 14px;
  color: #333;
  cursor: pointer;
  white-space: nowrap;
}
.menu-dropdown-item:hover { background: #f0f4ff; color: #2563EB; }

/* ==================== Tabæ  ==================== */
.tab-bar {
  height: 44px;
  background: #E6ECF5;
  border-bottom: 1px solid #d0d0d0;
  display: flex;
  align-items: center;
  padding: 4px 8px;
  gap: 8px;
  flex-shrink: 0;
}
.tab-item {
  height: 36px;
  padding: 0 16px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #374151;
  background: #D7DEE9;
  user-select: none;
  white-space: nowrap;
  transition: all 0.15s;
}
.tab-item:hover { background: #C4CFE0; }
.tab-item.active {
  background: #2563EB;
  color: #fff;
  font-weight: 600;
}

/* ==================== ä¸»å†…å®¹åŒº ==================== */
.main-content {
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}
.tab-content { display: none; flex: 1; overflow: hidden; }
.tab-content.active { display: flex; flex-direction: column; flex: 1; overflow: hidden; }

/* ==================== çŠ¶æ€æ  ==================== */
.status-bar {
  height: 32px;
  background: #F5F7FA;
  border-top: 1px solid #D0D0D0;
  display: flex;
  align-items: center;
  padding: 0 16px;
  flex-shrink: 0;
  font-size: 14px;
  color: #374151;
  justify-content: space-between;
}

/* ==================== é€šç”¨ç»„ä»¶ ==================== */
.card {
  background: #FFFFFF;
  border-radius: 12px;
  border: 1px solid #D9E1EC;
  padding: 14px 16px;
}
.card-title {
  font-size: 14px;
  font-weight: 700;
  color: #1F2937;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 6px;
}
.help-icon {
  font-size: 12px;
  color: #9CA3AF;
  cursor: pointer;
  width: 16px;
  height: 16px;
  border: 1px solid #9CA3AF;
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  user-select: none;
  transition: all 0.15s;
}
.help-icon:hover { color: #374151; border-color: #374151; }

.btn {
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-family: inherit;
  font-weight: 700;
  transition: all 0.15s;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
}
.btn:active { transform: scale(0.97); }
.btn-primary { background: #2563EB; color: #fff; }
.btn-primary:hover { background: #1d4ed8; }
.btn-secondary { background: #6B7280; color: #fff; }
.btn-secondary:hover { background: #4B5563; }
.btn-warning { background: #F59E0B; color: #fff; }
.btn-warning:hover { background: #D97706; }
.btn-orange { background: #EA580C; color: #fff; }
.btn-orange:hover { background: #C2410C; }
.btn-danger { background: #DC2626; color: #fff; }
.btn-danger:hover { background: #b91c1c; }
.btn-outline {
  background: #fff;
  border: 1px solid #D1D5DB;
  color: #374151;
}
.btn-outline:hover { background: #F3F4F6; }

.badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 10px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
}
.badge-green { background: #D1FAE5; color: #065F46; }
.badge-red { background: #FEE2E2; color: #991B1B; }
.badge-yellow { background: #FEF3C7; color: #92400E; }
.badge-blue { background: #DBEAFE; color: #1E40AF; }
.badge-gray { background: #F3F4F6; color: #6B7280; }

.form-row { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
.form-label { font-size: 14px; color: #374151; font-weight: 600; flex-shrink: 0; }
.form-input {
  height: 40px;
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  padding: 0 12px;
  font-size: 14px;
  font-family: inherit;
  outline: none;
  color: #1F2937;
}
.form-input:focus { border-color: #2563EB; box-shadow: 0 0 0 2px rgba(37,99,235,0.1); }
.form-select {
  height: 40px;
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  padding: 0 12px;
  font-size: 14px;
  font-family: inherit;
  outline: none;
  background: #fff;
  color: #1F2937;
}
.form-textarea {
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  padding: 8px 12px;
  font-size: 14px;
  font-family: inherit;
  outline: none;
  color: #1F2937;
  resize: none;
}
.form-textarea:focus { border-color: #2563EB; box-shadow: 0 0 0 2px rgba(37,99,235,0.1); }

/* è¡¨æ ¼ */
.data-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}
.data-table th {
  background: #F3F4F6;
  padding: 10px 12px;
  text-align: left;
  font-weight: 600;
  color: #374151;
  border-bottom: 2px solid #E5E7EB;
  white-space: nowrap;
}
.data-table td {
  padding: 10px 12px;
  border-bottom: 1px solid #E5E7EB;
  color: #374151;
}
.data-table tr:hover td { background: #F9FAFB; }
.data-table .row-even td { background: #FAFAFA; }

/* æ»šåŠ¨æ¡ */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: #F1F5F9; }
::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #94A3B8; }

/* ==================== å¼¹çª— ==================== */
.modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  z-index: 500;
  align-items: center;
  justify-content: center;
}
.modal-overlay.active { display: flex; }
.modal-box {
  background: #fff;
  border-radius: 16px;
  border: 2px solid #2563EB;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.25);
}
.modal-header {
  background: #2563EB;
  color: #fff;
  padding: 0 24px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
}
.modal-title { font-size: 18px; font-weight: 700; }
.modal-close-btn {
  width: 28px; height: 28px;
  border-radius: 50%;
  background: rgba(255,255,255,0.2);
  border: none;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
}
.modal-close-btn:hover { background: rgba(255,255,255,0.35); }
.modal-body { flex: 1; overflow-y: auto; padding: 24px; }
.modal-footer {
  padding: 16px 24px;
  border-top: 1px solid #E5E7EB;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 12px;
  flex-shrink: 0;
}

/* å¯†ç å¼¹çª— */
.pwd-box {
  background: #fff;
  border-radius: 12px;
  width: 380px;
  padding: 32px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.25);
  border: 1px solid #D9E1EC;
}
.pwd-title { font-size: 18px; font-weight: 700; color: #1F2937; margin-bottom: 20px; text-align: center; }
.pwd-input {
  width: 100%; height: 48px;
  border: 1px solid #D1D5DB; border-radius: 8px;
  padding: 0 16px; font-size: 18px; font-family: inherit;
  outline: none; text-align: center; letter-spacing: 4px; margin-bottom: 8px;
}
.pwd-input:focus { border-color: #2563EB; box-shadow: 0 0 0 2px rgba(37,99,235,0.1); }
.pwd-error { color: #DC2626; font-size: 13px; text-align: center; min-height: 20px; margin-bottom: 16px; }

/* ç¡®è®¤å¼¹çª— */
.confirm-box {
  background: #fff;
  border-radius: 12px;
  width: 420px;
  padding: 28px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.25);
  border: 1px solid #D9E1EC;
}

/* ==================== Tab1: æ•°æ®é‡‡é›†ä¸»ç•Œé¢ ==================== */
.data-collection-layout {
  display: flex;
  flex: 1;
  gap: 12px;
  padding: 12px;
  overflow: hidden;
}

/* å·¦ä¾§ */
.dc-left { width: 320px; flex-shrink: 0; display: flex; flex-direction: column; gap: 12px; overflow: hidden; }

/* äº§å“é€‰æ‹©åŒº */
.product-select-area { padding: 14px 16px; }
.product-dropdown {
  width: 100%; height: 40px;
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  padding: 0 12px;
  font-size: 14px;
  font-family: inherit;
  cursor: pointer;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23666' fill='none' stroke-width='2'/%3E%3C/svg%3E") right 12px center no-repeat #fff;
  -webkit-appearance: none;
  outline: none;
}
.product-info { font-size: 13px; color: #6B7280; margin-top: 6px; }
.product-num { font-size: 18px; color: #374151; font-weight: 600; }

.order-input {
  width: 100%; height: 48px;
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  padding: 0 12px;
  font-size: 18px;
  font-family: inherit;
  outline: none;
  margin-top: 8px;
}
.order-input:focus { border-color: #2563EB; }

/* æ•°é‡ç»Ÿè®¡ */
.qty-stats { padding: 14px 16px; }
.qty-item {
  text-align: center;
  padding: 10px 0;
  border-bottom: 1px solid #E5E7EB;
}
.qty-item:last-child { border-bottom: none; }
.qty-label { font-size: 16px; color: #374151; margin-bottom: 6px; }
.qty-fraction {
  font-size: 48px;
  font-weight: 700;
  line-height: 1;
  display: flex;
  align-items: baseline;
  justify-content: center;
  gap: 2px;
}
.qty-num { color: #2563EB; }
.qty-sep { color: #9CA3AF; font-size: 36px; margin: 0 2px; }
.qty-total { color: #DC2626; }
.qty-input {
  width: 80px;
  height: 56px;
  border: 2px solid #D1D5DB;
  border-radius: 8px;
  padding: 0 6px;
  font-size: 42px;
  font-weight: 700;
  color: #374151;
  font-family: inherit;
  outline: none;
  text-align: center;
  background: #FAFAFA;
  transition: border-color 0.15s;
  line-height: 1;
}
.qty-input:hover { border-color: #93C5FD; }
.qty-input:focus { border-color: #2563EB; background: #EFF6FF; }
/* éšè—æ•°å­—è¾“å…¥æ¡†çš„ä¸Šä¸‹ç®­å¤´ */
.qty-input::-webkit-inner-spin-button,
.qty-input::-webkit-outer-spin-button { opacity: 0; width: 0; }

/* ä¸­é—´æ  */
.dc-mid { flex: 1; display: flex; flex-direction: column; gap: 0; min-width: 0; overflow: hidden; }
.log-section { display: flex; flex-direction: column; overflow: hidden; }
.log-section-header {
  padding: 8px 14px;
  background: #F8FBFF;
  border-bottom: 1px solid #D7E7FF;
  font-size: 13px;
  font-weight: 600;
  color: #374151;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  transition: background 0.4s;
}
.log-section-header.flash-header {
  animation: headerFlash 0.6s ease-out;
}
.log-section-body { flex: 1; overflow-y: auto; padding: 8px 14px; }
.log-entry {
  padding: 4px 8px;
  border-radius: 4px;
  margin-bottom: 4px;
  font-size: 14px;
  line-height: 1.5;
  border-left: 3px solid transparent;
}
.le-data { color: #1F2937; border-color: #D1D5DB; }
.le-success { color: #16A34A; border-color: #16A34A; background: #F0FDF4; font-weight: 600; }
.le-warn { color: #92400E; border-color: #F59E0B; background: #FFFBEB; }
.le-error { color: #DC2626; border-color: #DC2626; background: #FEF2F2; font-weight: 600; }
.le-info { color: #374151; border-color: #9CA3AF; background: #F9FAFB; }
.ts { color: #9CA3AF; font-size: 12px; margin-right: 6px; }

/* æ—¥å¿—æ¡ç›®è¿›å…¥åŠ¨ç”» */
@keyframes logSlideIn {
  0%   { opacity: 0; transform: translateX(-18px) scaleY(0.7); max-height: 0; }
  60%  { opacity: 1; transform: translateX(3px) scaleY(1.04); max-height: 80px; }
  100% { opacity: 1; transform: translateX(0) scaleY(1); max-height: 80px; }
}
@keyframes logSuccessFlash {
  0%   { opacity: 0; transform: translateX(-18px); background: #DCFCE7; box-shadow: 0 0 0 2px #22C55E44; }
  50%  { background: #DCFCE7; box-shadow: 0 0 0 3px #22C55E44; }
  100% { opacity: 1; transform: translateX(0); background: #F0FDF4; box-shadow: none; }
}
@keyframes logErrorFlash {
  0%   { opacity: 0; transform: translateX(-18px); background: #FEE2E2; box-shadow: 0 0 0 2px #EF444444; }
  30%  { transform: translateX(4px); box-shadow: 0 0 0 3px #EF444444; }
  60%  { transform: translateX(-2px); background: #FEE2E2; }
  100% { opacity: 1; transform: translateX(0); background: #FEF2F2; box-shadow: none; }
}
@keyframes headerFlash {
  0%   { background: #EFF6FF; }
  50%  { background: #DBEAFE; }
  100% { background: #F8FBFF; }
}
@keyframes alarmPulse {
  0%   { background: #FEF2F2; }
  40%  { background: #FEE2E2; }
  100% { background: #FEF2F2; }
}
.log-entry-new       { animation: logSlideIn 0.35s cubic-bezier(.22,.68,0,1.2) both; }
.log-entry-success   { animation: logSuccessFlash 0.5s ease-out both; }
.log-entry-error     { animation: logErrorFlash 0.5s ease-out both; }
@keyframes dotPulse {
  0%, 100% { opacity: 1; transform: scale(1); box-shadow: 0 0 0 0 rgba(34,197,94,0.5); }
  50%       { opacity: 0.7; transform: scale(1.3); box-shadow: 0 0 0 4px rgba(34,197,94,0); }
}

/* å³ä¾§ */
.dc-right { width: 300px; flex-shrink: 0; display: flex; flex-direction: column; gap: 8px; overflow: hidden; }
.dc-right .card { flex: 1; display: flex; flex-direction: column; }
.ctrl-group { padding: 12px 14px; }
.ctrl-btn {
  width: 100%; height: 44px;
  margin-bottom: 6px; border-radius: 6px;
  font-size: 14px;
}
.ctrl-btn:last-child { margin-bottom: 0; }

.sync-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
}
.sync-ok { background: #D1FAE5; color: #065F46; }
.sync-ing { background: #FEF3C7; color: #92400E; animation: pulse 1.5s infinite; }
.sync-fail { background: #FEE2E2; color: #991B1B; }
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

.reject-count {
  font-size: 38px;
  font-weight: 700;
  color: #DC2626;
  display: inline-block;
  line-height: 1;
}

/* ==================== Tab2: æ‰‹å·¥é‡‡é›† ==================== */
.manual-layout {
  display: flex;
  flex: 1;
  gap: 12px;
  padding: 12px;
  overflow: hidden;
}
.manual-left { width: 40%; display: flex; flex-direction: column; gap: 12px; }
.manual-right { flex: 1; display: flex; flex-direction: column; gap: 12px; }

.radio-group { display: flex; gap: 24px; align-items: center; }
.radio-item {
  display: flex; align-items: center; gap: 8px;
  cursor: pointer; font-size: 16px; color: #374151;
}
.radio-item input[type="radio"] { width: 18px; height: 18px; accent-color: #2563EB; cursor: pointer; }

.count-big {
  font-size: 56px;
  font-weight: 700;
  color: #1F2937;
  text-align: center;
  line-height: 1;
}
.status-light {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 20px;
  border-radius: 8px;
  font-size: 15px;
  font-weight: 700;
}
.light-active { background: #D1FAE5; color: #065F46; }
.light-next { background: #FEF3C7; color: #92400E; }

.prompt-area {
  background: #F0F4FF;
  border-radius: 12px;
  border: 2px solid #BFDBFE;
  padding: 20px;
  text-align: center;
}
.prompt-main {
  font-size: 18px;
  color: #374151;
  margin-bottom: 12px;
}
.prompt-codes {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  font-size: 28px;
  font-weight: 700;
}
.code-scan { color: #2563EB; }
.code-wait { color: #D1D5DB; }
.code-divider { color: #9CA3AF; font-size: 24px; }

/* ==================== Tab3: ç åŒ…ç®¡ç† ==================== */
.package-layout {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
  padding: 12px;
  gap: 10px;
}
.toolbar { display: flex; gap: 10px; align-items: center; flex-shrink: 0; }
.filter-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
  background: #fff;
  border-radius: 10px;
  border: 1px solid #D9E1EC;
  padding: 10px 14px;
}

/* ==================== æ•°æ®æŸ¥è¯¢ ==================== */
.query-layout {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
  padding: 12px;
  gap: 10px;
}
.query-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
  background: #fff;
  border-radius: 10px;
  border: 1px solid #D9E1EC;
  padding: 12px 16px;
}
.query-status { font-size: 13px; color: #6B7280; }

.chain-path {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 14px 16px;
  background: #F8FBFF;
  border-radius: 8px;
  border: 1px solid #DBEAFE;
  font-size: 15px;
  flex-wrap: wrap;
}
.chain-tag {
  display: inline-flex;
  align-items: center;
  padding: 4px 12px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 600;
}
.chain-arrow { color: #9CA3AF; font-size: 18px; }

.level-bottle { background: #EFF6FF; color: #1D4ED8; }
.level-box { background: #F0FDF4; color: #15803D; }
.level-case { background: #FFF7ED; color: #C2410C; }
.level-pallet { background: #FAF5FF; color: #7C3AED; }

/* ==================== æ•°æ®æ›¿æ¢ ==================== */
.replace-layout {
  display: flex;
  flex: 1;
  gap: 16px;
  padding: 16px;
  overflow: hidden;
  align-items: flex-start;
}
.replace-left { width: 480px; flex-shrink: 0; }
.replace-right { flex: 1; }

/* ==================== å–æ¶ˆå…³è” ==================== */
.cancel-layout {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
  padding: 12px;
  gap: 10px;
}
.cancel-mode-bar {
  display: flex;
  gap: 0;
  flex-shrink: 0;
}
.cancel-mode-btn {
  padding: 9px 28px;
  border: 1px solid #D1D5DB;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  font-family: inherit;
  background: #fff;
  color: #374151;
  transition: all 0.15s;
}
.cancel-mode-btn:first-child { border-radius: 6px 0 0 6px; }
.cancel-mode-btn:last-child { border-radius: 0 6px 6px 0; border-left: none; }
.cancel-mode-btn.active { background: #2563EB; color: #fff; border-color: #2563EB; }
.cancel-body { display: flex; flex: 1; gap: 12px; overflow: hidden; min-height: 0; }
.cancel-left { width: 420px; flex-shrink: 0; overflow-y: auto; display: flex; flex-direction: column; gap: 0; }
.cancel-left .card { border-radius: 12px; }
.cancel-right { flex: 1; display: flex; flex-direction: column; gap: 10px; overflow: hidden; min-width: 0; }
.cancel-form { display: none; flex-direction: column; gap: 14px; }
.cancel-form.active { display: flex; }
.cancel-field-label {
  font-size: 16px; font-weight: 700; color: #1F2937;
  margin-bottom: 6px; display: flex; align-items: center; gap: 6px;
}
.cancel-field-label .req { color: #DC2626; }
.cancel-input {
  width: 100%; height: 48px;
  border: 1.5px solid #D1D5DB; border-radius: 8px;
  padding: 0 14px; font-size: 16px; font-family: inherit;
  outline: none; transition: border-color 0.15s;
}
.cancel-input:focus { border-color: #2563EB; }
.cancel-warn {
  background: #FEF2F2; border: 1px solid #FCA5A5;
  border-radius: 8px; padding: 10px 14px;
  font-size: 15px; font-weight: 700; color: #DC2626;
  display: flex; align-items: center; gap: 8px;
}
.cancel-action-row { display: flex; gap: 12px; align-items: center; }
/* è¯†åˆ«ç»“æœå¡ç‰‡ */
.cr-item {
  border-radius: 8px; padding: 12px 14px;
  margin-bottom: 10px; border: 1px solid #E5E7EB;
  font-size: 14px; line-height: 1.8;
}
.cr-item:last-child { margin-bottom: 0; }
.cr-ok  { background: #F0FDF4; border-color: #86EFAC; }
.cr-err { background: #FEF2F2; border-color: #FCA5A5; }
.cr-badge {
  display: inline-flex; align-items: center;
  padding: 2px 10px; border-radius: 20px;
  font-size: 13px; font-weight: 700; margin-right: 6px;
}
.cr-badge-ok  { background: #DCFCE7; color: #15803D; }
.cr-badge-err { background: #FEE2E2; color: #DC2626; }
.cr-chain { font-size: 13px; color: #6B7280; margin-top: 4px; padding-left: 4px; border-left: 2px solid #D1D5DB; }
.cr-summary {
  background: #FEF9C3; border: 1px solid #FDE047;
  border-radius: 8px; padding: 10px 14px;
  font-size: 14px; font-weight: 700; color: #854D0E;
  margin-top: 4px;
}
/* å–æ¶ˆç»“æœæ—¥å¿— */
.cancel-log-body { flex: 1; overflow-y: auto; padding: 10px 14px; }
.cl-entry { font-size: 14px; margin-bottom: 8px; line-height: 1.6; }
.cl-ok   { color: #15803D; }
.cl-fail { color: #DC2626; }
.cl-ts   { color: #9CA3AF; font-size: 12px; margin-right: 6px; }
/* æ‰¹é‡ç åˆ—è¡¨ */
.batch-list {
  border: 1px solid #E5E7EB; border-radius: 8px;
  max-height: 160px; overflow-y: auto; background: #F9FAFB;
}
.batch-list-item {
  display: flex; justify-content: space-between; align-items: center;
  padding: 7px 12px; border-bottom: 1px solid #E5E7EB;
  font-size: 14px; color: #374151;
}
.batch-list-item:last-child { border-bottom: none; }
.batch-del-btn {
  background: none; border: none; color: #DC2626;
  cursor: pointer; font-size: 13px; font-weight: 600; font-family: inherit;
}
.batch-del-btn:hover { text-decoration: underline; }

/* ==================== ç”Ÿäº§ç»Ÿè®¡ ==================== */
.stats-layout {
  display: flex;
  flex: 1;
  gap: 12px;
  padding: 12px;
  overflow: hidden;
}
.stats-left { width: 280px; flex-shrink: 0; display: flex; flex-direction: column; gap: 12px; }
.stats-right { flex: 1; display: flex; flex-direction: column; gap: 10px; overflow: hidden; }
.stat-card {
  background: #F0F4FF;
  border: 1px solid #BFDBFE;
  border-radius: 10px;
  padding: 14px 16px;
  text-align: center;
  cursor: pointer;
  transition: all 0.15s;
}
.stat-card:hover { background: #DBEAFE; border-color: #93C5FD; }
.stat-card-plain { background: #F9FAFB; border-color: #E5E7EB; cursor: default; }
.stat-card-plain:hover { background: #F9FAFB; border-color: #E5E7EB; }
.stat-num {
  font-size: 48px;
  font-weight: 700;
  color: #1D4ED8;
  text-decoration: underline;
  line-height: 1;
}
.stat-num-plain { color: #1F2937; text-decoration: none; }
.stat-label { font-size: 14px; color: #6B7280; margin-bottom: 6px; }

/* ==================== æ•°æ®ä¸Šä¼  ==================== */
.upload-layout {
  display: flex;
  flex: 1;
  gap: 12px;
  padding: 12px;
  overflow: hidden;
}
.upload-left { width: 40%; display: flex; flex-direction: column; gap: 12px; overflow: hidden; }
.upload-right { flex: 1; display: flex; flex-direction: column; gap: 12px; overflow: hidden; }
.upload-log {
  flex: 1;
  overflow-y: auto;
  background: #F9FAFB;
  border: 1px solid #E5E7EB;
  border-radius: 8px;
  padding: 12px;
}
.ul-entry { font-size: 14px; margin-bottom: 6px; }
.ul-gray { color: #9CA3AF; }
.ul-blue { color: #2563EB; }
.ul-green { color: #16A34A; font-weight: 600; }
.ul-red { color: #DC2626; font-weight: 600; }

/* ç³»ç»Ÿè®¾ç½® */
.sys-tab-bar { display: flex; border-bottom: 1px solid #E5E7EB; background: #F9FAFB; padding: 0 16px; }
.sys-tab { padding: 10px 18px; font-size: 14px; color: #6B7280; cursor: pointer; border-bottom: 3px solid transparent; margin-bottom: -1px; }
.sys-tab.active { color: #2563EB; border-color: #2563EB; font-weight: 600; }
.sys-tab-panel { display: none; padding: 20px 24px; overflow-y: auto; }
.sys-tab-panel.active { display: block; }
.device-table { width: 100%; border-collapse: collapse; font-size: 14px; }
.device-table th { background: #F3F4F6; padding: 8px 12px; text-align: left; font-weight: 600; color: #374151; border: 1px solid #E5E7EB; }
.device-table td { padding: 8px 12px; border: 1px solid #E5E7EB; color: #374151; }
.btn-sm { height: 28px; padding: 0 10px; font-size: 12px; font-weight: 600; border-radius: 4px; border: none; cursor: pointer; font-family: inherit; }
.btn-sm-blue { background: #EFF6FF; color: #2563EB; } .btn-sm-blue:hover { background: #DBEAFE; }
.btn-sm-red { background: #FEF2F2; color: #DC2626; } .btn-sm-red:hover { background: #FEE2E2; }
.btn-sm-green { background: #F0FDF4; color: #16A34A; } .btn-sm-green:hover { background: #DCFCE7; }

.toggle-track { width: 40px; height: 22px; background: #E5E7EB; border-radius: 11px; position: relative; cursor: pointer; transition: background 0.2s; display: inline-block; }
.toggle-track.on { background: #2563EB; }
.toggle-thumb { width: 18px; height: 18px; background: #fff; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: transform 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
.toggle-track.on .toggle-thumb { transform: translateX(18px); }

/* ==================== æ“ä½œå¸®åŠ©å¼¹çª— ==================== */
.help-toc-item {
  padding: 8px 16px;
  font-size: 14px;
  color: #374151;
  cursor: pointer;
  border-left: 3px solid transparent;
  transition: all 0.15s;
  user-select: none;
}
.help-toc-item:hover { background: #EFF6FF; color: #2563EB; }
.help-toc-item.active { background: #EFF6FF; color: #2563EB; border-left-color: #2563EB; font-weight: 600; }
.help-toc-sub {
  padding: 5px 16px 5px 28px;
  font-size: 13px;
  color: #6B7280;
  cursor: pointer;
  border-left: 3px solid transparent;
  transition: all 0.15s;
  user-select: none;
}
.help-toc-sub:hover { background: #F0F4FF; color: #2563EB; }
.help-toc-sub.active { color: #2563EB; font-weight: 600; }
.help-section { margin-bottom: 32px; padding-bottom: 24px; border-bottom: 1px solid #E5E7EB; }
.help-section:last-child { border-bottom: none; }
.help-h1 {
  font-size: 20px; font-weight: 700; color: #1F2937;
  margin-bottom: 16px; padding-bottom: 8px;
  border-bottom: 2px solid #2563EB;
}
.help-h2 {
  font-size: 16px; font-weight: 700; color: #1F2937;
  margin: 16px 0 8px;
}
.help-step-title {
  font-size: 15px; font-weight: 700; color: #374151;
  margin: 12px 0 6px;
}
.help-ul, .help-ol {
  margin: 0 0 8px 20px;
  color: #374151;
}
.help-ul li, .help-ol li { margin-bottom: 4px; }
.help-warn {
  color: #DC2626; font-weight: 600;
  list-style: none !important;
}
.help-warn::before { content: ''; }
.help-table {
  width: 100%; border-collapse: collapse;
  font-size: 14px; margin: 10px 0;
}
.help-table th {
  background: #F3F4F6; padding: 8px 12px;
  text-align: left; font-weight: 600; color: #374151;
  border: 1px solid #E5E7EB;
}
.help-table td {
  padding: 8px 12px; border: 1px solid #E5E7EB; color: #374151;
}
.help-table tr:nth-child(even) td { background: #FAFAFA; }
.help-info-box {
  background: #FFF7ED; border: 1px solid #FCD34D;
  border-radius: 8px; padding: 14px 16px;
  margin: 10px 0; color: #92400E; font-size: 14px;
}
.help-faq-item {
  background: #F9FAFB; border: 1px solid #E5E7EB;
  border-radius: 8px; padding: 14px 16px;
  margin-bottom: 12px;
}
.help-faq-q {
  font-size: 15px; font-weight: 700; color: #1D4ED8;
  margin-bottom: 8px;
}
.help-faq-a { font-size: 14px; color: #374151; line-height: 1.7; }
.help-badge-warn {
  display: inline-flex; align-items: center;
  background: #FEF3C7; color: #92400E;
  border-radius: 20px; padding: 2px 10px;
  font-size: 13px; font-weight: 600;
  border: 1px solid #FCD34D;
  margin-left: 8px;
}

/* å¸®åŠ©æµ®å±‚ */
.help-popup {
  display: none;
  position: absolute;
  background: #fff;
  border: 1px solid #CCCCCC;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  padding: 12px 16px;
  font-size: 14px;
  color: #333;
  max-width: 350px;
  z-index: 300;
  line-height: 1.7;
}
.help-popup.show { display: block; }

/* äº§å“é€‰æ‹©å¼¹çª— */
.product-modal { width: 800px; max-height: 600px; }
</style>
</head>
<body>

<!-- èœå•æ  -->
<div class="menu-bar">
  <div class="menu-item">æ–‡ä»¶(F)<div class="menu-dropdown"><div class="menu-dropdown-item" onclick="confirmExit()">é€€å‡ºè½¯ä»¶</div></div></div>
  <div class="menu-item">é…ç½®<div class="menu-dropdown"><div class="menu-dropdown-item" onclick="openSysSettings()">ç³»ç»Ÿè®¾ç½®</div></div></div>
  <div class="menu-item">æ•°æ®<div class="menu-dropdown">
    <div class="menu-dropdown-item" onclick="switchTab('tab-package')">ç åŒ…ç®¡ç†</div>
    <div class="menu-dropdown-item" onclick="switchTab('tab-query')">æ•°æ®æŸ¥è¯¢</div>
    <div class="menu-dropdown-item" onclick="switchTab('tab-replace')">æ•°æ®æ›¿æ¢</div>
    <div class="menu-dropdown-item" onclick="switchTab('tab-cancel')">å–æ¶ˆå…³è”</div>
    <div class="menu-dropdown-item" onclick="switchTab('tab-stats')">ç”Ÿäº§ç»Ÿè®¡</div>
    <div class="menu-dropdown-item" onclick="switchTab('tab-upload')">æ•°æ®ä¸Šä¼ </div>
    <div class="menu-dropdown-item" onclick="alert('æ“ä½œæ—¥å¿—åŠŸèƒ½')">æ“ä½œæ—¥å¿—</div>
  </div></div>
  <div class="menu-item">å¸®åŠ©(H)<div class="menu-dropdown">
    <div class="menu-dropdown-item" onclick="openHelpModal()">æ“ä½œå¸®åŠ©</div>
    <div class="menu-dropdown-item" onclick="alert('ç›’ç®±å›å…³è”é‡‡é›†ç³»ç»Ÿ v1.2\nçŸ³æ¹¾äº§çº¿ 2å·æœº')">å…³äºç³»ç»Ÿ</div>
  </div></div>
  <div style="margin-left:auto; font-size:13px; color:#6B7280;">ç›’ç®±å›å…³è”é‡‡é›†ç³»ç»Ÿ - 2å·æœº</div>
</div>

<!-- Tabæ  -->
<div class="tab-bar">
  <div class="tab-item active" id="tabBtn-collection" onclick="switchTab('tab-collection')">æ•°æ®é‡‡é›†</div>
  <div class="tab-item" id="tabBtn-manual" onclick="switchTab('tab-manual')">æ‰‹å·¥é‡‡é›†</div>
  <div class="tab-item" id="tabBtn-query" onclick="switchTab('tab-query')">æ•°æ®æŸ¥è¯¢</div>
  <div class="tab-item" id="tabBtn-replace" onclick="switchTab('tab-replace')">æ•°æ®æ›¿æ¢</div>
  <div class="tab-item" id="tabBtn-stats" onclick="switchTab('tab-stats')">ç”Ÿäº§ç»Ÿè®¡</div>
  <div class="tab-item" id="tabBtn-package" onclick="switchTab('tab-package')">ç åŒ…ç®¡ç†</div>
  <div class="tab-item" id="tabBtn-cancel" onclick="switchTab('tab-cancel')">å–æ¶ˆå…³è”</div>
  <div class="tab-item" id="tabBtn-upload" onclick="switchTab('tab-upload')">æ•°æ®ä¸Šä¼ </div>
</div>

<!-- ä¸»å†…å®¹åŒº -->
<div class="main-content">

<!-- ===================== Tab1: æ•°æ®é‡‡é›† ===================== -->
<div class="tab-content active" id="tab-collection">
  <div class="data-collection-layout">

    <!-- å·¦ä¾§æ  -->
    <div class="dc-left">
      <!-- ç”Ÿäº§äº§å“é€‰æ‹© -->
      <div class="card product-select-area">
        <div class="card-title">ç”Ÿäº§äº§å“é€‰æ‹©</div>
        <div style="font-size:13px; color:#6B7280; margin-bottom:4px;">é€‰æ‹©äº§å“</div>
        <select class="product-dropdown" id="productSelect" onchange="updateProductInfo()" style="width:100%">
          <option value="">-- ç‚¹å‡»é€‰æ‹©äº§å“ --</option>
          <option value="P001">çŸ³æ¹¾é…’ 52åº¦ 500ml</option>
          <option value="P002">çŸ³æ¹¾é…’ 38åº¦ 500ml</option>
          <option value="P003">çŸ³æ¹¾é…’ 42åº¦ 250ml</option>
          <option value="P004">çŸ³æ¹¾é…’ 52åº¦ 250ml</option>
        </select>
        <div id="productCodeArea" style="display:none; margin-top:8px;">
          <div class="product-info">äº§å“ç¼–å·</div>
          <div class="product-num" id="productCodeDisplay">â€”</div>
        </div>
        <div style="margin-top:12px; font-size:13px; color:#6B7280; margin-bottom:4px;">ç”Ÿäº§å•å·</div>
        <input type="text" class="order-input" id="orderNum" value="20241201001">
      </div>

      <!-- æ•°é‡å®æ—¶ç»Ÿè®¡ -->
      <div class="card qty-stats" style="flex:1;">
        <div class="card-title">æ•°é‡å®æ—¶ç»Ÿè®¡</div>
        <div class="qty-item">
          <div class="qty-label">æ¯ç®±ç›’æ•°</div>
          <div class="qty-fraction">
            <span class="qty-num" id="curBoxes">0</span>
            <span class="qty-sep">/</span>
            <input type="number" id="boxPerCase" value="4" min="1" class="qty-input" title="æ¯ç®±ç›’æ•°">
          </div>
        </div>
        <div class="qty-item" style="padding-top:12px;">
          <div class="qty-label">æ¯å›ç®±æ•°</div>
          <div class="qty-fraction">
            <span class="qty-num" id="curCases">0</span>
            <span class="qty-sep">/</span>
            <input type="number" id="casePerPallet" value="70" min="1" class="qty-input" title="æ¯å›ç®±æ•°">
          </div>
        </div>
      </div>
    </div>

    <!-- ä¸­é—´æ  -->
    <div class="dc-mid">
      <div class="card" style="flex:1; display:flex; flex-direction:column; overflow:hidden; padding:0; gap:0;">
        <!-- æ•°æ®æ¥æ”¶åŒº 60% -->
        <div class="log-section" style="flex:3; border-bottom:1px solid #E5E7EB;">
          <div class="log-section-header" id="dataAreaHeader">
            <span>ğŸ“¡ æ•°æ®æ¥æ”¶åŒº <span style="font-size:11px; color:#9CA3AF; font-weight:400;">ï¼ˆæœ€æ–°åœ¨ä¸Šï¼‰</span></span>
            <span id="receivingDot" style="display:none; align-items:center; gap:5px; font-size:12px; color:#16A34A; font-weight:500;">
              <span style="display:inline-block; width:7px; height:7px; border-radius:50%; background:#22C55E; animation:dotPulse 1s ease-in-out infinite;"></span>æ¥æ”¶ä¸­
            </span>
          </div>
          <div class="log-section-body" id="dataArea">
            <div class="log-entry le-success"><span class="ts">10:30:18</span>âš¡ æ»¡å›æç¤º - å›ç ï¼šP20241201003 å·²ç”Ÿæˆï¼Œå…±70ç®±ï¼Œæ­£åœ¨ä¸Šä¼ ...</div>
            <div class="log-entry le-data"><span class="ts">10:30:16</span>è£…ç®±å®Œæˆ - ç®±ç ï¼š20241201001003 å·²å…³è”4ç›’ï¼Œå…±24ç“¶</div>
            <div class="log-entry le-data"><span class="ts">10:30:16</span>ç›’ç®±å…³è” - ç›’ç ï¼š20241201001002 â†’ ç®±ç ï¼š20241201001003</div>
            <div class="log-entry le-data"><span class="ts">10:30:14</span>ç›’ç®±å…³è” - ç›’ç ï¼š20241201001001 â†’ ç®±ç ï¼š20241201001003</div>
            <div class="log-entry le-data"><span class="ts">10:30:12</span>æ¥æ”¶1å·æœºæ•°æ® - ç“¶ç›’å…³è”ï¼šç›’ç 20241201001002ï¼ˆ6ç“¶ï¼‰</div>
            <div class="log-entry le-data"><span class="ts">10:30:10</span>æ¥æ”¶1å·æœºæ•°æ® - ç“¶ç›’å…³è”ï¼šç›’ç 20241201001001ï¼ˆ6ç“¶ï¼‰</div>
            <div class="log-entry le-success"><span class="ts">10:29:58</span>âœ“ å›ç ï¼šP20241201002 ä¸Šä¼ æˆåŠŸ</div>
            <div class="log-entry le-data"><span class="ts">10:29:45</span>æ»¡å› - å›ç ï¼šP20241201002 å·²ç”Ÿæˆ</div>
          </div>
        </div>
        <!-- æ“ä½œæ—¥å¿— 20% -->
        <div class="log-section" style="flex:1; border-bottom:1px solid #E5E7EB;">
          <div class="log-section-header">
            <span>ğŸ“‹ æ“ä½œæ—¥å¿— <span style="font-size:11px; color:#9CA3AF; font-weight:400;">ï¼ˆæœ€æ–°åœ¨ä¸Šï¼‰</span></span>
          </div>
          <div class="log-section-body" id="opLogArea">
            <div class="log-entry le-info"><span class="ts">10:30:15</span>è®¾å¤‡åˆå§‹åŒ–å®Œæˆï¼Œå·²è¿æ¥2ä¸ªè®¾å¤‡</div>
            <div class="log-entry le-info"><span class="ts">10:30:01</span>å¼€å§‹é‡‡é›† - äº§å“ï¼šçŸ³æ¹¾é…’52åº¦500mlï¼Œç”Ÿäº§å•ï¼š20241201001</div>
            <div class="log-entry le-info"><span class="ts">10:29:55</span>ç³»ç»Ÿå¯åŠ¨å®Œæˆ</div>
          </div>
        </div>
        <!-- æŠ¥è­¦ä¿¡æ¯ 20% -->
        <div class="log-section" style="flex:1;">
          <div class="log-section-header">
            <span>âš  æŠ¥è­¦ä¿¡æ¯ <span style="font-size:11px; color:#9CA3AF; font-weight:400;">ï¼ˆæœ€æ–°åœ¨ä¸Šï¼‰</span></span>
          </div>
          <div class="log-section-body" id="alarmArea">
            <div class="log-entry le-error"><span class="ts">10:30:15</span>é‡ç : 20241201001001 - å·²åœ¨ç åŒ…ä¸­å‡ºç°è¿‡</div>
          </div>
        </div>
      </div>
    </div>

    <!-- å³ä¾§æ  -->
    <div class="dc-right">
      <!-- é‡‡é›†æ§åˆ¶ -->
      <div class="card ctrl-group" style="justify-content:space-between;">
        <div class="card-title">é‡‡é›†æ§åˆ¶ <span class="help-icon" onclick="showHelp('é‡‡é›†æ§åˆ¶', 'å¼€å§‹/åœæ­¢é‡‡é›†ï¼šç³»ç»Ÿæ£€æµ‹ç¡¬ä»¶åå¼€å§‹é‡‡é›†ï¼›å†æ¬¡ç‚¹å‡»åœæ­¢ï¼Œæœªæ»¡å›æ•°æ®ä¿ç•™ã€‚\næ— éœ€é‡‡é›†ç ï¼šä¸ç”Ÿäº§äº”ç åˆä¸€äº§å“æ—¶å¼€å¯ï¼Œæ‰€æœ‰è¯»ç è®¾å¤‡ä¸å·¥ä½œã€‚\nå…³é—­æŠ¥è­¦ï¼šé‡ç½®æŠ¥è­¦çŠ¶æ€ï¼Œåœæ­¢å£°å…‰æŠ¥è­¦å™¨ã€‚')">?</span></div>
        <button class="btn btn-primary ctrl-btn" id="collectBtn" onclick="toggleCollect()" style="font-size:16px; flex:1; max-height:52px;">å¼€å§‹é‡‡é›†</button>
        <div style="display:flex; gap:8px; flex-shrink:0;">
          <button class="btn btn-secondary ctrl-btn" onclick="alert('æ— éœ€é‡‡é›†ç åŠŸèƒ½å·²å¼€å¯')" style="flex:1; font-size:13px; margin-bottom:0;">æ— éœ€é‡‡é›†ç </button>
          <button class="btn btn-secondary ctrl-btn" onclick="closeAlarmDC()" style="flex:1; font-size:13px; margin-bottom:0;">å…³é—­æŠ¥è­¦</button>
        </div>
      </div>

      <!-- å›ç›¸å…³ -->
      <div class="card ctrl-group" style="justify-content:space-between;">
        <div class="card-title">å›ç›¸å…³ <span class="help-icon" onclick="showHelp('å›ç›¸å…³', 'å¼ºåˆ¶æ»¡å›ï¼šæœªè¾¾åˆ°è®¾å®šç®±æ•°ä¹Ÿå¼ºåˆ¶ç»“æŸå½“å‰å›ï¼Œç”Ÿæˆè™šæ‹Ÿå›æ ‡å¹¶é‡ç½®è®¡æ•°ã€‚\næ¸…ç©ºå›ï¼šæ¸…é™¤å½“å‰å›è®¡æ•°ï¼Œé‡ç½®ç»Ÿè®¡æ•°æ®ã€‚\næå–å·¥å•æœªæˆå›ï¼šæå–ä¹‹å‰æœªå®Œæˆå›çš„æ•°æ®ï¼Œå¯ç»§ç»­ç”Ÿäº§ã€‚')">?</span></div>
        <button class="btn btn-warning ctrl-btn" onclick="forcePallet()" style="font-size:14px; flex:1; max-height:52px;">å¼ºåˆ¶æ»¡å›</button>
        <div style="display:flex; gap:8px; flex-shrink:0;">
          <button class="btn btn-secondary ctrl-btn" onclick="clearPallet()" style="flex:1; font-size:13px; margin-bottom:0;">æ¸…ç©ºå›</button>
          <button class="btn btn-primary ctrl-btn" onclick="extractUnfinished()" style="flex:1; font-size:12px; margin-bottom:0;">æå–å·¥å•æœªæˆå›</button>
        </div>
      </div>

      <!-- å‰”é™¤ç­‰ -->
      <div class="card ctrl-group" style="justify-content:space-between;">
        <div class="card-title">å‰”é™¤ç­‰ <span class="help-icon" onclick="showHelp('å‰”é™¤ç­‰', 'æ”¶å›å‰”é™¤ï¼šå‰”é™¤è®¾å¤‡æœªè‡ªåŠ¨æ”¶å›æ—¶ï¼Œç‚¹å‡»æ­¤æŒ‰é’®æ”¶å›å‰”é™¤åŠ¨ä½œï¼ˆPLCæ§åˆ¶ï¼‰ã€‚\næ€»å‰”é™¤æ•°ï¼šç´¯è®¡å‰”é™¤æ•°é‡ï¼Œè‡ªåŠ¨ç´¯è®¡ã€‚\næ¸…é›¶ï¼šå°†æ€»å‰”é™¤æ•°é‡ç½®ä¸º0ã€‚')">?</span></div>
        <button class="btn btn-orange ctrl-btn" onclick="alert('å·²å‘é€æ”¶å›æŒ‡ä»¤åˆ°PLC')" style="font-size:14px; flex:1; max-height:52px;">æ”¶å›å‰”é™¤</button>
        <div style="display:flex; align-items:center; gap:8px; flex-shrink:0;">
          <div style="flex:1; display:flex; align-items:center; gap:8px;">
            <span style="font-size:13px; color:#6B7280; white-space:nowrap;">æ€»å‰”é™¤æ•°</span>
            <span class="reject-count" id="rejectCount">0</span>
          </div>
          <button class="btn btn-secondary ctrl-btn" onclick="resetReject()" style="flex:1; font-size:14px; margin-bottom:0;">æ¸…é›¶</button>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ===================== Tab2: æ‰‹å·¥é‡‡é›† ===================== -->
<div class="tab-content" id="tab-manual">
  <div class="manual-layout">
    <div class="manual-left">
      <!-- å…³è”ç±»å‹é€‰æ‹© -->
      <div class="card">
        <div class="card-title">å…³è”ç±»å‹é€‰æ‹©</div>
        <div class="radio-group">
          <label class="radio-item"><input type="radio" name="assocType" value="bottle-box" checked onchange="updateManualUI()"> ç“¶ç›’å…³è”</label>
          <label class="radio-item"><input type="radio" name="assocType" value="box-case" onchange="updateManualUI()"> ç›’ç®±å…³è”</label>
        </div>
      </div>
      <!-- åŒ…è£…æ¯”ä¾‹è®¾ç½® -->
      <div class="card">
        <div class="card-title" id="manualRatioTitle">äº§å“åŒ…è£…æ¯”ä¾‹è®¾ç½®</div>
        <div style="display:flex; gap:12px;">
          <div style="flex:1; background:#F0FDF4; border:1px solid #BBF7D0; border-radius:10px; padding:14px; text-align:center;">
            <div class="status-light light-active" id="scanLight" style="justify-content:center; margin-bottom:8px;">â— ç“¶ç æ‰«æä¸­</div>
            <div style="font-size:13px; color:#374151; margin-bottom:4px;" id="currentCountLabel">å½“å‰å·²è¯»ç“¶ç æ•°</div>
            <div class="count-big" id="currentCount">0</div>
          </div>
          <div style="flex:1; background:#F9FAFB; border:1px solid #E5E7EB; border-radius:10px; padding:14px; text-align:center;">
            <div style="font-size:13px; color:#6B7280; margin-bottom:4px;" id="perCountLabel">æ¯ç“¶ç æ•°ï¼ˆæ¯ç›’ï¼‰</div>
            <input type="number" id="manualN" value="6" min="1" max="24" style="width:80px; height:50px; border:1px solid #D1D5DB; border-radius:6px; font-size:32px; font-weight:700; text-align:center; font-family:inherit; outline:none; border-color:#2563EB;">
          </div>
        </div>
      </div>
      <!-- ç”Ÿäº§ç»Ÿè®¡ -->
      <div class="card">
        <div class="card-title">ç”Ÿäº§ç»Ÿè®¡</div>
        <div style="text-align:center;">
          <div style="font-size:14px; color:#6B7280; margin-bottom:6px;">ç”Ÿäº§æ€»æ•°</div>
          <div style="font-size:64px; font-weight:700; color:#1F2937; line-height:1;" id="manualTotal">0</div>
        </div>
        <button class="btn btn-secondary" style="width:100%; height:40px; margin-top:12px; font-size:14px;" onclick="if(confirm('ç¡®è®¤æ¸…é›¶ç”Ÿäº§ç»Ÿè®¡ï¼Ÿ')){document.getElementById('manualTotal').textContent='0';document.getElementById('currentCount').textContent='0';}">æ¸…é›¶</button>
      </div>
    </div>
    <div class="manual-right">
      <!-- é‡‡é›†æç¤º -->
      <div class="prompt-area">
        <div class="prompt-main">å½“å‰åº”æ‰«</div>
        <div class="prompt-codes">
          <span class="code-scan" id="promptCode1">ç“¶ç </span>
          <span class="code-divider">/</span>
          <span class="code-wait" id="promptCode2">ç›’ç </span>
        </div>
        <div style="font-size:13px; color:#6B7280; margin-top:12px;">ç“¶ç ç¯äº® - è¯·ç»§ç»­æ‰«æç“¶ç </div>
      </div>
      <!-- æ‰‹å·¥è¯»ç ä¿¡æ¯æ  -->
      <div class="card" style="flex:1; padding:0; overflow:hidden; display:flex; flex-direction:column;">
        <div class="log-section-header" style="border-radius:12px 12px 0 0;">
          æ‰‹å·¥è¯»ç ä¿¡æ¯æ ï¼ˆå€’åºæ˜¾ç¤ºï¼Œæœ€æ–°åœ¨ä¸Šï¼‰
        </div>
        <div class="log-section-body" id="manualLogArea">
          <div class="log-entry le-info"><span class="ts">10:30:40</span>è¿›å…¥æ‰‹å·¥é‡‡é›†æ¨¡å¼ - å…³è”ç±»å‹ï¼šç“¶ç›’å…³è”</div>
          <div class="log-entry le-info"><span class="ts">10:30:40</span>è®¾å¤‡çŠ¶æ€ï¼šæ‰«ç æªå·²å°±ç»ªï¼Œç­‰å¾…æ‰«ç </div>
          <div class="log-entry le-success"><span class="ts">10:30:38</span>ç›’ç å…³è”æˆåŠŸï¼š20241201002001ï¼ˆ6ç“¶â†’1ç›’ï¼‰</div>
          <div class="log-entry le-data"><span class="ts">10:30:36</span>æ‰«ç å®Œæˆï¼Œè¯·æ‰«ç›’ç </div>
          <div class="log-entry le-data"><span class="ts">10:30:35</span>ç“¶ç é‡‡é›†ï¼š20241201010006</div>
          <div class="log-entry le-data"><span class="ts">10:30:34</span>ç“¶ç é‡‡é›†ï¼š20241201010005</div>
          <div class="log-entry le-data"><span class="ts">10:30:33</span>ç“¶ç é‡‡é›†ï¼š20241201010004</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== Tab3: æ•°æ®æŸ¥è¯¢ ===================== -->
<div class="tab-content" id="tab-query">
  <div class="query-layout">
    <div class="card" style="flex-shrink:0; padding:12px 16px;">
      <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
        <span style="font-size:14px; color:#374151; font-weight:600; white-space:nowrap;">ç è¾“å…¥ï¼š</span>
        <input type="text" class="form-input" id="queryInput" placeholder="è¯·è¾“å…¥ç ä¿¡æ¯æˆ–ä½¿ç”¨æ‰«ç æªæ‰«æ..." style="flex:1; min-width:300px;" onkeydown="if(event.key==='Enter')doForwardQuery()">
        <button class="btn btn-primary" style="height:40px; padding:0 20px; font-size:14px;" onclick="doForwardQuery()">æ­£å‘æŸ¥è¯¢</button>
        <button class="btn" style="background:#16A34A; color:#fff; height:40px; padding:0 20px; font-size:14px;" onclick="doReverseQuery()">åå‘æŸ¥è¯¢</button>
        <button class="btn btn-outline" style="height:40px; padding:0 16px; font-size:14px;" onclick="clearQuery()">æ¸…ç©º</button>
        <span class="help-icon" onclick="showQueryHelp()" style="width:24px;height:24px;font-size:14px;">?</span>
      </div>
      <div style="margin-top:8px; font-size:13px;" id="queryStatus"><span style="color:#9CA3AF;">è¯·è¾“å…¥ç è¿›è¡ŒæŸ¥è¯¢</span></div>
    </div>

    <!-- æŸ¥è¯¢ç»“æœ -->
    <div id="queryResult" style="flex:1; overflow-y:auto; display:none;">
      <div class="card" style="margin-bottom:10px; padding:14px 16px;">
        <div style="font-size:14px; font-weight:600; color:#374151; margin-bottom:8px;">æŸ¥è¯¢ç ä¿¡æ¯ï¼š</div>
        <div style="display:flex; gap:20px; align-items:center; flex-wrap:wrap; font-size:16px;">
          <div>ç å€¼ï¼š<span style="color:#2563EB; font-weight:600;" id="qCodeVal">â€”</span></div>
          <div>å±‚çº§ï¼š<span id="qCodeLevel" class="chain-tag level-box">ç›’ç </span></div>
          <div>é‡‡é›†æ—¶é—´ï¼š<span style="color:#374151;" id="qCodeTime">â€”</span></div>
        </div>
      </div>

      <!-- æ­£å‘æŸ¥è¯¢ç»“æœ -->
      <div id="forwardResult" style="display:none;">
        <div class="card">
          <div class="card-title" id="forwardResultTitle">æ­£å‘æŸ¥è¯¢ç»“æœï¼ˆç›´æ¥ä¸‹çº§ - ç“¶ç ï¼‰ï¼š</div>
          <div id="forwardTableWrap"></div>
        </div>
      </div>

      <!-- åå‘æŸ¥è¯¢ç»“æœ -->
      <div id="reverseResult" style="display:none;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-title">ä¸Šçº§å…³è”è·¯å¾„ï¼š</div>
          <div class="chain-path" id="chainPath"></div>
        </div>
        <div class="card">
          <div class="card-title" id="sameLevel">åŒçº§æ•°æ®ï¼ˆå½“å‰ç›’ç å†…çš„å…¶ä»–ç“¶ç ï¼‰ï¼š</div>
          <div id="reverseTableWrap"></div>
        </div>
      </div>
    </div>

    <!-- ç©ºçŠ¶æ€ -->
    <div id="queryEmpty" style="flex:1; display:flex; align-items:center; justify-content:center; color:#9CA3AF; font-size:15px;">
      <div style="text-align:center;"><div style="font-size:48px; margin-bottom:12px;">ğŸ”</div>è¯·è¾“å…¥ç è¿›è¡ŒæŸ¥è¯¢</div>
    </div>
  </div>
</div>

<!-- ===================== Tab4: æ•°æ®æ›¿æ¢ ===================== -->
<div class="tab-content" id="tab-replace">
  <div class="replace-layout">
    <div class="replace-left">
      <div class="card">
        <div class="card-title">ç æ›¿æ¢</div>
        <div style="margin-bottom:16px;">
          <div style="font-size:14px; font-weight:600; color:#374151; margin-bottom:6px;">* åŸç  <span class="help-icon" onclick="showHelp('åŸç è¯´æ˜','è¯·è¾“å…¥éœ€è¦æ›¿æ¢çš„åŸç ï¼Œè¯¥ç å¿…é¡»å·²åœ¨ç³»ç»Ÿä¸­å­˜åœ¨å…³è”å…³ç³»')">?</span></div>
          <input type="text" class="form-input" id="origCode" placeholder="è¯·è¾“å…¥æˆ–æ‰«æåŸç ï¼ˆå¾…æ›¿æ¢çš„ç ï¼‰" style="width:100%;">
        </div>
        <div style="margin-bottom:16px;">
          <div style="font-size:14px; font-weight:600; color:#374151; margin-bottom:6px;">* æ–°ç  <span class="help-icon" onclick="showHelp('æ–°ç è¯´æ˜','æ–°ç å¿…é¡»åœ¨å·²å¯¼å…¥çš„ç åŒ…èŒƒå›´å†…ï¼Œä¸”æœªè¢«ä½¿ç”¨è¿‡ï¼ˆç³»ç»Ÿä¸­ä¸å­˜åœ¨è¯¥ç çš„å…³è”å…³ç³»ï¼‰')">?</span></div>
          <input type="text" class="form-input" id="newCode" placeholder="è¯·è¾“å…¥æˆ–æ‰«ææ–°ç ï¼ˆæ›¿æ¢åçš„ç ï¼‰" style="width:100%;">
        </div>
        <div style="margin-bottom:16px;">
          <div style="font-size:14px; font-weight:600; color:#374151; margin-bottom:6px;">æ›¿æ¢åŸå› </div>
          <textarea class="form-textarea" id="replaceReason" placeholder="è¯·è¾“å…¥æ›¿æ¢åŸå› ï¼ˆå¦‚ï¼šç æŸåã€ç é”™è¯¯ç­‰ï¼‰" style="width:100%; height:60px;"></textarea>
        </div>
        <div style="background:#FEF2F2; border:1px solid #FCA5A5; border-radius:6px; padding:10px 14px; margin-bottom:16px; font-size:14px; color:#DC2626; font-weight:600;">
          âš  æ›¿æ¢æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·ç¡®è®¤ç å€¼æ— è¯¯åå†æ‰§è¡Œæ›¿æ¢ã€‚
        </div>
        <div style="display:flex; gap:12px;">
          <button class="btn btn-secondary" style="height:48px; width:80px; font-size:15px;" onclick="clearReplace()">æ¸…ç©º</button>
          <button class="btn btn-primary" style="height:48px; flex:1; font-size:15px;" onclick="openReplaceConfirm()">ç¡®è®¤æ›¿æ¢</button>
        </div>
      </div>
    </div>
    <div class="replace-right">
      <div class="card" style="height:100%; display:flex; flex-direction:column;">
        <div class="card-title">æ›¿æ¢ç»“æœ</div>
        <div style="flex:1; background:#F9FAFB; border:1px solid #E5E7EB; border-radius:8px; overflow-y:auto; padding:12px;" id="replaceResultArea">
          <div style="color:#9CA3AF; text-align:center; padding:40px 0; font-size:15px;">æš‚æ— æ›¿æ¢è®°å½•</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== Tab5: ç”Ÿäº§ç»Ÿè®¡ ===================== -->
<div class="tab-content" id="tab-stats">
  <div class="stats-layout">
    <div class="stats-left">
      <div class="card">
        <div class="card-title">ç”Ÿäº§ç»Ÿè®¡</div>
        <div style="margin-bottom:10px; font-size:13px; color:#6B7280;">æ—¥æœŸèŒƒå›´:</div>
        <input type="date" class="form-input" style="width:100%; margin-bottom:8px;" value="2024-12-01">
        <input type="date" class="form-input" style="width:100%; margin-bottom:10px;" value="2024-12-31">
        <button class="btn btn-primary" style="width:100%; height:48px; font-size:15px;" onclick="doStatsQuery()">æŸ¥è¯¢</button>
      </div>
      <div class="stat-card" onclick="openPalletList()">
        <div class="stat-label">å›æ•°</div>
        <div class="stat-num" id="statPallet">100</div>
        <div style="font-size:11px; color:#6B7280; margin-top:4px;">ç‚¹å‡»æŸ¥çœ‹å›ç åˆ—è¡¨</div>
      </div>
      <div class="stat-card stat-card-plain">
        <div class="stat-label">ç®±æ•°</div>
        <div class="stat-num stat-num-plain" id="statCase">7000</div>
      </div>
      <div class="stat-card stat-card-plain">
        <div class="stat-label">ç›’æ•°</div>
        <div class="stat-num stat-num-plain" id="statBox">28000</div>
      </div>
    </div>
    <div class="stats-right">
      <div class="card" style="flex-shrink:0; padding:12px 16px;">
        <div class="card-title">ä¸Šä¼ ç»Ÿè®¡</div>
        <div style="display:flex; gap:10px; align-items:center;">
          <span style="font-size:13px; color:#374151;">æ—¥æœŸï¼š</span>
          <input type="date" class="form-input" style="width:140px;" value="2024-12-01">
          <span style="font-size:13px; color:#374151;">~</span>
          <input type="date" class="form-input" style="width:140px;" value="2024-12-31">
          <span style="font-size:13px; color:#374151;">çŠ¶æ€ï¼š</span>
          <select class="form-select" style="width:100px;"><option>å…¨éƒ¨</option><option>æˆåŠŸ</option><option>å¼‚å¸¸</option></select>
          <button class="btn btn-primary" style="height:40px; padding:0 20px; font-size:14px;">æŸ¥è¯¢</button>
        </div>
      </div>
      <div class="card" style="flex:1; padding:0; overflow:hidden; display:flex; flex-direction:column;">
        <table class="data-table" style="flex-shrink:0;">
          <thead>
            <tr>
              <th style="width:150px;">å›ç </th>
              <th style="width:80px;">ä¸Šä¼ çŠ¶æ€</th>
              <th style="width:180px;">ä¸Šä¼ æ—¶é—´</th>
              <th style="width:60px;">ç®±æ•°</th>
              <th>å¼‚å¸¸åŸå› </th>
            </tr>
          </thead>
        </table>
        <div style="flex:1; overflow-y:auto;">
          <table class="data-table">
            <tbody>
              <tr><td>D001-2410101</td><td><span class="badge badge-green">æˆåŠŸ</span></td><td>2024-12-01 10:30:15</td><td>70</td><td>-</td></tr>
              <tr class="row-even"><td>D002-2410101</td><td><span class="badge badge-green">æˆåŠŸ</span></td><td>2024-12-01 10:35:22</td><td>70</td><td>-</td></tr>
              <tr><td>D003-2410101</td><td><span class="badge badge-red">å¼‚å¸¸</span></td><td>2024-12-01 10:40:18</td><td>70</td><td>ç½‘ç»œè¶…æ—¶</td></tr>
              <tr class="row-even"><td>D004-2410101</td><td><span class="badge badge-green">æˆåŠŸ</span></td><td>2024-12-01 10:45:33</td><td>70</td><td>-</td></tr>
              <tr><td>D005-2410101</td><td><span class="badge badge-red">å¼‚å¸¸</span></td><td>2024-12-01 10:50:47</td><td>70</td><td>æœåŠ¡å™¨é”™è¯¯(500)</td></tr>
              <tr class="row-even"><td>D006-2410101</td><td><span class="badge badge-green">æˆåŠŸ</span></td><td>2024-12-01 10:55:12</td><td>70</td><td>-</td></tr>
              <tr><td>D007-2410101</td><td><span class="badge badge-green">æˆåŠŸ</span></td><td>2024-12-01 11:00:28</td><td>70</td><td>-</td></tr>
              <tr class="row-even"><td>D008-2410101</td><td><span class="badge badge-red">å¼‚å¸¸</span></td><td>2024-12-01 11:05:56</td><td>70</td><td>ç½‘ç»œè¶…æ—¶</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== Tab6: ç åŒ…ç®¡ç† ===================== -->
<div class="tab-content" id="tab-package">
  <div class="package-layout">
    <div class="toolbar">
      <button class="btn btn-primary" style="height:40px; padding:0 20px; font-size:14px;" onclick="alert('é€‰æ‹©æœ¬åœ°ç åŒ…æ–‡ä»¶å¯¼å…¥')">æœ¬åœ°å¯¼å…¥</button>
      <button class="btn btn-secondary" style="height:40px; padding:0 20px; font-size:14px;" onclick="alert('æ­£åœ¨ä»åœ¨çº¿æºæ‹‰å–ç åŒ…...')">åœ¨çº¿æ›´æ–°</button>
    </div>
    <div class="filter-bar">
      <span style="font-size:13px; color:#374151; font-weight:600;">å…³é”®è¯ï¼š</span>
      <input type="text" class="form-input" placeholder="æ¨¡ç³ŠåŒ¹é…ç åŒ…åç§°..." style="width:180px;">
      <span style="font-size:13px; color:#374151; font-weight:600;">å¯¼å…¥æ—¶é—´ï¼š</span>
      <input type="date" class="form-input" style="width:130px;" value="2024-12-01">
      <span style="color:#9CA3AF;">~</span>
      <input type="date" class="form-input" style="width:130px;" value="2024-12-31">
      <span style="font-size:13px; color:#374151; font-weight:600;">å¯¼å…¥æ–¹å¼ï¼š</span>
      <select class="form-select" style="width:90px;"><option>å…¨éƒ¨</option><option>åœ¨çº¿</option><option>æœ¬åœ°</option></select>
      <span style="font-size:13px; color:#374151; font-weight:600;">çŠ¶æ€ï¼š</span>
      <select class="form-select" style="width:80px;"><option>å…¨éƒ¨</option><option>æ­£å¸¸</option><option>å·²åˆ é™¤</option></select>
      <button class="btn btn-primary" style="height:36px; padding:0 16px; font-size:13px;">æœç´¢</button>
      <button class="btn btn-outline" style="height:36px; padding:0 16px; font-size:13px;">é‡ç½®</button>
    </div>
    <div class="card" style="flex:1; padding:0; overflow:hidden; display:flex; flex-direction:column;">
      <div style="flex:1; overflow-y:auto;">
        <table class="data-table" style="table-layout:fixed; width:100%;">
          <colgroup>
            <col style="width:200px;">
            <col style="width:160px;">
            <col style="width:90px;">
            <col style="width:130px;">
            <col style="width:80px;">
            <col style="width:120px;">
            <col style="width:120px;">
          </colgroup>
          <thead>
            <tr>
              <th style="position:sticky;top:0;z-index:2;">ç åŒ…åç§°</th>
              <th style="position:sticky;top:0;z-index:2;">å¯¼å…¥æ—¶é—´</th>
              <th style="position:sticky;top:0;z-index:2;">å¯¼å…¥æ–¹å¼</th>
              <th style="position:sticky;top:0;z-index:2;">ç åŒ…æ•°é‡ï¼ˆå»é‡ï¼‰</th>
              <th style="position:sticky;top:0;z-index:2;">çŠ¶æ€</th>
              <th style="position:sticky;top:0;z-index:2;">å¤‡æ³¨</th>
              <th style="position:sticky;top:0;z-index:2;">æ“ä½œ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>ç“¶ç åŒ…2024120101</td><td>2024-12-01 10:00:00</td><td>åœ¨çº¿</td><td>10,000</td>
              <td><span class="badge badge-green">æ­£å¸¸</span></td><td>çŸ³æ¹¾æ‰¹æ¬¡1</td>
              <td><button class="btn-sm btn-sm-blue" onclick="viewPackage('ç“¶ç åŒ…2024120101')">æŸ¥çœ‹</button> <button class="btn-sm btn-sm-red" onclick="if(confirm('ç¡®è®¤åˆ é™¤æ­¤ç åŒ…ï¼Ÿ'))alert('å·²åˆ é™¤')">åˆ é™¤</button></td>
            </tr>
            <tr class="row-even">
              <td>ç®±ç åŒ…2024120101</td><td>2024-12-01 09:00:00</td><td>æœ¬åœ°</td><td>5,000</td>
              <td><span class="badge badge-green">æ­£å¸¸</span></td><td>çŸ³æ¹¾æ‰¹æ¬¡1</td>
              <td><button class="btn-sm btn-sm-blue" onclick="viewPackage('ç®±ç åŒ…2024120101')">æŸ¥çœ‹</button> <button class="btn-sm btn-sm-red" onclick="if(confirm('ç¡®è®¤åˆ é™¤æ­¤ç åŒ…ï¼Ÿ'))alert('å·²åˆ é™¤')">åˆ é™¤</button></td>
            </tr>
            <tr>
              <td>ç“¶ç åŒ…2024113001</td><td>2024-11-30 16:00:00</td><td>åœ¨çº¿</td><td>8,500</td>
              <td><span class="badge badge-green">æ­£å¸¸</span></td><td>æ˜¨æ—¥æ‰¹æ¬¡</td>
              <td><button class="btn-sm btn-sm-blue" onclick="viewPackage('ç“¶ç åŒ…2024113001')">æŸ¥çœ‹</button> <button class="btn-sm btn-sm-red" onclick="if(confirm('ç¡®è®¤åˆ é™¤æ­¤ç åŒ…ï¼Ÿ'))alert('å·²åˆ é™¤')">åˆ é™¤</button></td>
            </tr>
            <tr class="row-even">
              <td>å›ç åŒ…20241130</td><td>2024-11-30 08:00:00</td><td>æœ¬åœ°</td><td>200</td>
              <td><span class="badge badge-gray">å·²åˆ é™¤</span></td><td>æ—§æ‰¹æ¬¡</td>
              <td><button class="btn-sm btn-sm-blue" onclick="viewPackage('å›ç åŒ…20241130')">æŸ¥çœ‹</button></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="padding:10px 16px; border-top:1px solid #E5E7EB; display:flex; align-items:center; justify-content:space-between; font-size:14px; color:#374151; flex-shrink:0;">
        <span>å…± 4 æ¡</span>
        <div style="display:flex; align-items:center; gap:8px;">
          <button class="btn btn-outline" style="height:32px; padding:0 12px; font-size:13px;">ä¸Šä¸€é¡µ</button>
          <span>ç¬¬ 1 é¡µ</span>
          <button class="btn btn-outline" style="height:32px; padding:0 12px; font-size:13px;">ä¸‹ä¸€é¡µ</button>
          <select class="form-select" style="width:80px; height:32px; font-size:13px;"><option>20æ¡</option><option>50æ¡</option><option>100æ¡</option></select>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== Tab7: å–æ¶ˆå…³è” ===================== -->
<div class="tab-content" id="tab-cancel">
  <div class="cancel-layout">

    <!-- æ¨¡å¼åˆ‡æ¢ -->
    <div class="cancel-mode-bar" style="flex-shrink:0;">
      <button class="cancel-mode-btn active" id="cancelSingle" onclick="switchCancelMode('single')">å•ä¸ªå–æ¶ˆå…³è”</button>
      <button class="cancel-mode-btn" id="cancelBatch" onclick="switchCancelMode('batch')">æ‰¹é‡å–æ¶ˆå…³è”</button>
    </div>

    <!-- ä¸»ä½“ï¼šå·¦ä¾§è¡¨å• + å³ä¾§ç»“æœ -->
    <div class="cancel-body">

      <!-- å·¦ä¾§ï¼šè¡¨å•åŒºï¼ˆä¸¤ç§æ¨¡å¼åˆ‡æ¢ï¼‰ -->
      <div class="cancel-left">

        <!-- å•ä¸ªæ¨¡å¼è¡¨å• -->
        <div class="card cancel-form active" id="cancelSingleContent" style="padding:20px;">
          <div style="font-size:20px; font-weight:700; color:#1F2937; margin-bottom:18px;">å•ä¸ªå–æ¶ˆå…³è”</div>

          <div>
            <div class="cancel-field-label"><span class="req">*</span> ç¬¬ä¸€ä¸ªç  <span class="help-icon" onclick="showHelp('ç¬¬ä¸€ä¸ªç ','è¯·è¾“å…¥åŒä¸€åŒ…è£…å†…çš„ä»»æ„ä¸€ä¸ªç ï¼ˆç“¶ç /ç›’ç /ç®±ç /å›ç å‡å¯ï¼‰')">?</span></div>
            <input type="text" class="cancel-input" id="code1" placeholder="è¯·è¾“å…¥æˆ–æ‰«æç¬¬ä¸€ä¸ªç ">
          </div>

          <div>
            <div class="cancel-field-label"><span class="req">*</span> ç¬¬äºŒä¸ªç  <span class="help-icon" onclick="showHelp('ç¬¬äºŒä¸ªç ','è¯·è¾“å…¥ä¸ç¬¬ä¸€ä¸ªç åŒä¸€åŒ…è£…å†…çš„å¦ä¸€ä¸ªç ')">?</span></div>
            <input type="text" class="cancel-input" id="code2" placeholder="è¯·è¾“å…¥æˆ–æ‰«æç¬¬äºŒä¸ªç ï¼ˆåŒä¸€åŒ…è£…å†…çš„ä»»æ„ä¸¤ä¸ªç ï¼‰">
          </div>

          <div>
            <button class="btn btn-primary" style="height:48px; width:100px; font-size:16px; font-weight:700;" onclick="doRecognize()">è¯†åˆ«</button>
          </div>

          <div class="cancel-warn">âš  æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·ç¡®è®¤åæ‰§è¡Œã€‚</div>

          <div class="cancel-action-row">
            <button class="btn btn-secondary" style="height:48px; width:80px; font-size:16px;" onclick="clearCancel()">æ¸…ç©º</button>
            <button class="btn btn-danger" style="height:48px; flex:1; font-size:16px; font-weight:700;" id="confirmCancelBtn" disabled onclick="openCancelConfirm('single')">ç¡®è®¤å–æ¶ˆå…³è”</button>
          </div>
          <div id="cancelBtnHint" style="font-size:13px; color:#9CA3AF; display:none;">âš  æœ‰ä¸Šçº§å…³è”ï¼Œè¯·å…ˆä»å›å¼€å§‹é€çº§è§£é™¤</div>
        </div>

        <!-- æ‰¹é‡æ¨¡å¼è¡¨å• -->
        <div class="card cancel-form" id="cancelBatchContent" style="padding:20px;">
          <div style="font-size:20px; font-weight:700; color:#1F2937; margin-bottom:18px;">æ‰¹é‡å–æ¶ˆå…³è”</div>

          <div>
            <div class="cancel-field-label"><span class="req">*</span> å¤§ç  <span class="help-icon" onclick="showHelp('å¤§ç ','è¯·è¾“å…¥éœ€è¦å–æ¶ˆå…³è”çš„ç›’ç ã€ç®±ç æˆ–å›ç ')">?</span></div>
            <div style="display:flex; gap:8px;">
              <input type="text" class="cancel-input" id="batchCode" placeholder="è¯·è¾“å…¥æˆ–æ‰«æå¤§ç ï¼ˆç›’ç /ç®±ç /å›ç ï¼‰" style="flex:1;">
              <button class="btn btn-primary" style="height:48px; width:80px; font-size:16px; font-weight:700;" onclick="addBatchCode()">æ·»åŠ </button>
            </div>
          </div>

          <div>
            <div style="font-size:16px; font-weight:700; color:#1F2937; margin-bottom:8px;">å·²æ·»åŠ çš„å¤§ç åˆ—è¡¨</div>
            <div class="batch-list" id="batchCodeList">
              <div style="color:#9CA3AF; font-size:14px; text-align:center; padding:20px 0;">æš‚æ— æ·»åŠ çš„å¤§ç </div>
            </div>
          </div>

          <div>
            <button class="btn btn-primary" style="height:48px; width:100px; font-size:16px; font-weight:700;" onclick="doBatchRecognize()">è¯†åˆ«</button>
          </div>

          <div class="cancel-warn">âš  æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·ç¡®è®¤åæ‰§è¡Œã€‚</div>

          <div class="cancel-action-row">
            <button class="btn btn-secondary" style="height:48px; width:80px; font-size:16px;" onclick="clearBatch()">æ¸…ç©º</button>
            <button class="btn btn-danger" style="height:48px; flex:1; font-size:15px; font-weight:700;" onclick="openCancelConfirm('batch')">ç¡®è®¤æ‰¹é‡å–æ¶ˆå…³è”</button>
          </div>
        </div>

      </div><!-- /cancel-left -->

      <!-- å³ä¾§ï¼šè¯†åˆ«ç»“æœï¼ˆä¸Šï¼‰+ å–æ¶ˆç»“æœï¼ˆä¸‹ï¼‰å…±ç”¨ -->
      <div class="cancel-right">

        <!-- è¯†åˆ«ç»“æœ -->
        <div class="card" style="flex:1; display:flex; flex-direction:column; overflow:hidden; padding:0; min-height:0;">
          <div class="log-section-header" style="border-radius:12px 12px 0 0; font-size:15px;">
            <span>è¯†åˆ«ç»“æœ</span>
            <span id="recognizeHint" style="font-size:12px; color:#9CA3AF; font-weight:400;">è¯†åˆ«åå°†åœ¨æ­¤æ˜¾ç¤º</span>
          </div>
          <div style="flex:1; overflow-y:auto; padding:14px;" id="recognizeResult">
            <div style="color:#9CA3AF; font-size:15px; text-align:center; padding-top:60px;">è¯·åœ¨å·¦ä¾§è¾“å…¥ç å€¼å¹¶ç‚¹å‡»è¯†åˆ«</div>
          </div>
        </div>

        <!-- å–æ¶ˆç»“æœ -->
        <div class="card" style="height:220px; display:flex; flex-direction:column; overflow:hidden; padding:0; flex-shrink:0;">
          <div class="log-section-header" style="border-radius:12px 12px 0 0; font-size:15px;">
            <span>å–æ¶ˆç»“æœ</span>
            <button style="background:none;border:none;font-size:12px;color:#9CA3AF;cursor:pointer;font-family:inherit;" onclick="document.getElementById('cancelResultLog').innerHTML='<div style=\'color:#9CA3AF;font-size:14px;text-align:center;padding:20px;\'>æš‚æ— å–æ¶ˆå…³è”è®°å½•</div>'">æ¸…ç©ºè®°å½•</button>
          </div>
          <div class="cancel-log-body" id="cancelResultLog">
            <div style="color:#9CA3AF; font-size:14px; text-align:center; padding:20px;">æš‚æ— å–æ¶ˆå…³è”è®°å½•</div>
          </div>
        </div>

      </div><!-- /cancel-right -->
    </div><!-- /cancel-body -->
  </div>
</div>

<!-- ===================== Tab8: æ•°æ®ä¸Šä¼  ===================== -->
<div class="tab-content" id="tab-upload">
  <div class="upload-layout">
    <div class="upload-left">
      <div class="card" style="flex-shrink:0;">
        <button class="btn btn-primary" style="height:48px; font-size:15px; width:120px;" onclick="doManualUpload()">æ‰‹åŠ¨ä¸Šä¼ </button>
        <span class="help-icon" style="margin-left:8px;" onclick="showHelp('æ‰‹åŠ¨ä¸Šä¼ ','æ‰¹é‡ä¸Šä¼ æ‰€æœ‰æœªä¸Šä¼ çš„å›æ•°æ®')">?</span>
      </div>
      <div class="card" style="flex:1; padding:0; overflow:hidden; display:flex; flex-direction:column;">
        <div class="log-section-header" style="border-radius:12px 12px 0 0;">
          ä¸Šä¼ ä¿¡æ¯ï¼ˆæœ€æ–°åœ¨ä¸Šï¼‰
        </div>
        <div class="upload-log" id="uploadLogArea">
          <div class="ul-entry ul-green"><span class="ts">14:35:20</span>å›ç  D005-2410101 ä¸Šä¼ æˆåŠŸ</div>
          <div class="ul-entry ul-blue"><span class="ts">14:35:18</span>å›ç  D005-2410101 ä¸Šä¼ ä¸­...</div>
          <div class="ul-entry ul-gray"><span class="ts">14:35:15</span>å›ç  D005-2410101 å¼€å§‹ä¸Šä¼ </div>
          <div class="ul-entry ul-red"><span class="ts">14:30:22</span>å›ç  D004-2410101 ä¸Šä¼ å¤±è´¥ï¼Œç½‘ç»œè¶…æ—¶</div>
          <div class="ul-entry ul-blue"><span class="ts">14:30:21</span>å›ç  D004-2410101 ä¸Šä¼ ä¸­...</div>
          <div class="ul-entry ul-gray"><span class="ts">14:30:20</span>å›ç  D004-2410101 å¼€å§‹ä¸Šä¼ </div>
          <div class="ul-entry ul-green"><span class="ts">14:25:10</span>å›ç  D003-2410101 ä¸Šä¼ æˆåŠŸ</div>
          <div class="ul-entry ul-blue"><span class="ts">14:25:08</span>å›ç  D003-2410101 ä¸Šä¼ ä¸­...</div>
          <div class="ul-entry ul-gray"><span class="ts">14:25:05</span>å›ç  D003-2410101 å¼€å§‹ä¸Šä¼ </div>
        </div>
      </div>
    </div>
    <div class="upload-right">
      <div class="card" style="flex-shrink:0;">
        <div class="card-title">å›ç æŸ¥è¯¢ä¸çŠ¶æ€ç®¡ç†</div>
        <input type="text" class="form-input" id="uploadQueryCode" placeholder="è¯·è¾“å…¥å›ç " style="width:100%; margin-bottom:10px;">
        <div style="display:flex; gap:8px; align-items:center;">
          <button class="btn btn-primary" style="height:48px; padding:0 16px; font-size:14px;" onclick="queryUploadStatus()">æŸ¥è¯¢çŠ¶æ€</button>
          <button class="btn btn-outline" style="height:48px; padding:0 14px; font-size:14px;" onclick="setNotUploaded()">è®¾ä¸ºæœªä¸Šä¼ </button>
          <button class="btn btn-outline" style="height:48px; padding:0 14px; font-size:14px;" onclick="setUploaded()">è®¾ä¸ºå·²ä¸Šä¼ </button>
          <span class="help-icon" style="width:22px;height:22px;font-size:13px;" onclick="showHelp('çŠ¶æ€ç®¡ç†', 'æŸ¥è¯¢çŠ¶æ€ï¼šæŸ¥è¯¢æŒ‡å®šå›ç çš„ä¸Šä¼ çŠ¶æ€è¯¦æƒ…\nè®¾ä¸ºæœªä¸Šä¼ ï¼šå°†å›ç çŠ¶æ€é‡ç½®ä¸ºæœªä¸Šä¼ ï¼Œç”¨äºæ•°æ®ä¿®å¤åé‡æ–°è¡¥ä¼ \nè®¾ä¸ºå·²ä¸Šä¼ ï¼šæ‰‹åŠ¨æ ‡è®°ä¸ºå·²ä¸Šä¼ ï¼Œé¿å…ç³»ç»Ÿé‡å¤ä¸Šä¼ æ­¤å›')">?</span>
        </div>
      </div>
      <div class="card" style="flex:1;">
        <div id="uploadQueryResult" style="color:#9CA3AF; font-size:14px; text-align:center; padding:40px 0;">è¯·è¾“å…¥å›ç å¹¶ç‚¹å‡»æŸ¥è¯¢çŠ¶æ€</div>
      </div>
    </div>
  </div>
</div>

</div><!-- /main-content -->

<!-- çŠ¶æ€æ  -->
<div class="status-bar">
  <div style="display:flex; align-items:center; gap:10px;">
    <span style="font-size:13px; color:#6B7280;">1å·æœºæ•°æ®åŒæ­¥ï¼š</span>
    <span class="sync-indicator sync-ok" id="syncStatus"><span>â—</span> å·²åŒæ­¥</span>
  </div>
  <span id="currentTime2">2024-12-01 10:30:00</span>
</div>

<!-- ==================== å¼¹çª—åŒºåŸŸ ==================== -->

<!-- æ“ä½œå¸®åŠ©å¼¹çª— -->
<div class="modal-overlay" id="helpOverlay" onclick="if(event.target===this)closeHelpModal()">
  <div class="modal-box" style="width:900px; height:80vh; display:flex; flex-direction:column;">
    <div class="modal-header">
      <span class="modal-title">ğŸ“– æ“ä½œå¸®åŠ©</span>
      <button class="modal-close-btn" onclick="closeHelpModal()">âœ•</button>
    </div>
    <div style="flex:1; display:flex; overflow:hidden; min-height:0;">
      <!-- å·¦ä¾§ç›®å½• -->
      <div id="helpToc" style="width:180px; flex-shrink:0; border-right:1px solid #E5E7EB; overflow-y:auto; padding:16px 0; background:#F9FAFB;">
        <div style="font-size:12px; color:#9CA3AF; font-weight:700; padding:0 16px 8px; letter-spacing:1px;">ç›®å½•</div>
        <div class="help-toc-item" onclick="scrollHelpTo('h-intro')">ä¸€ã€ç³»ç»Ÿç®€ä»‹</div>
        <div class="help-toc-item" onclick="scrollHelpTo('h-m1')">äºŒã€1å·æœºæ“ä½œ</div>
        <div class="help-toc-item" onclick="scrollHelpTo('h-m2')">ä¸‰ã€2å·æœºæ“ä½œ</div>
        <div class="help-toc-item" onclick="scrollHelpTo('h-funcs')">å››ã€å„åŠŸèƒ½è¯´æ˜</div>
        <div class="help-toc-sub" onclick="scrollHelpTo('h-manual')">â†³ æ‰‹å·¥é‡‡é›†</div>
        <div class="help-toc-sub" onclick="scrollHelpTo('h-package')">â†³ ç åŒ…ç®¡ç†</div>
        <div class="help-toc-sub" onclick="scrollHelpTo('h-query')">â†³ æ•°æ®æŸ¥è¯¢</div>
        <div class="help-toc-sub" onclick="scrollHelpTo('h-replace')">â†³ æ•°æ®æ›¿æ¢</div>
        <div class="help-toc-sub" onclick="scrollHelpTo('h-cancel')">â†³ å–æ¶ˆå…³è”</div>
        <div class="help-toc-sub" onclick="scrollHelpTo('h-stats')">â†³ ç”Ÿäº§ç»Ÿè®¡</div>
        <div class="help-toc-sub" onclick="scrollHelpTo('h-upload')">â†³ æ•°æ®ä¸Šä¼ </div>
        <div class="help-toc-item" onclick="scrollHelpTo('h-faq')">äº”ã€å¸¸è§é—®é¢˜</div>
        <div class="help-toc-item" onclick="scrollHelpTo('h-notes')">å…­ã€æ³¨æ„äº‹é¡¹</div>
      </div>
      <!-- å³ä¾§æ­£æ–‡ -->
      <div id="helpContent" style="flex:1; overflow-y:auto; padding:28px 32px; font-size:15px; line-height:1.8; color:#1F2937;">

        <div class="help-section" id="h-intro">
          <div class="help-h1">ä¸€ã€ç³»ç»Ÿç®€ä»‹</div>
          <div class="help-h2">1.1 ç³»ç»Ÿç»„æˆ</div>
          <p>æœ¬ç³»ç»Ÿé‡‡ç”¨<strong>å››çº§å…³è”æ¨¡å¼</strong>ï¼ˆç“¶-ç›’-ç®±-å›ï¼‰ï¼Œç”±ä¸¤ä¸ªç‹¬ç«‹è½¯ä»¶ç»„æˆï¼š</p>
          <ul class="help-ul">
            <li><strong>1å·æœºï¼ˆç“¶ç›’å…³è”è½¯ä»¶ï¼‰</strong>ï¼šè´Ÿè´£ç“¶ç å’Œç›’ç çš„é‡‡é›†å…³è”ï¼Œæ•°æ®å®æ—¶åŒæ­¥è‡³2å·æœº</li>
            <li><strong>2å·æœºï¼ˆç›’ç®±å›å…³è”è½¯ä»¶ï¼‰</strong>ï¼šè´Ÿè´£ç›’ç®±å›å…³è”é‡‡é›†ã€æ•°æ®ç®¡ç†å’Œæ•°æ®ä¸Šä¼ </li>
          </ul>
          <div class="help-h2">1.2 åŒ…è£…è§„æ ¼</div>
          <p style="color:#6B7280; font-size:13px;">é»˜è®¤å€¼ï¼Œå¯åœ¨ç³»ç»Ÿè®¾ç½®ä¸­é…ç½®ï¼Œå‹¿éšæ„ä¿®æ”¹</p>
          <table class="help-table">
            <thead><tr><th>å±‚çº§</th><th>å…³ç³»</th></tr></thead>
            <tbody>
              <tr><td>1ç›’</td><td>= 6ç“¶</td></tr>
              <tr><td>1ç®±</td><td>= 4ç›’ï¼ˆ24ç“¶ï¼‰</td></tr>
              <tr><td>1å›</td><td>= 70ç®±ï¼ˆ280ç›’ï¼Œ1680ç“¶ï¼‰</td></tr>
            </tbody>
          </table>
        </div>

        <div class="help-section" id="h-m1">
          <div class="help-h1">äºŒã€1å·æœºæ“ä½œæŒ‡å—ï¼ˆç“¶ç›’å…³è”è½¯ä»¶ï¼‰</div>
          <div class="help-h2">2.1 æ—¥å¸¸æ“ä½œæµç¨‹</div>
          <div class="help-step-title">æ­¥éª¤1ï¼šç¡®è®¤åŒ…è£…æ¯”ä¾‹</div>
          <ul class="help-ul">
            <li>åœ¨å·¦ä¾§ã€ŒåŒ…è£…æ¯”ä¾‹è®¾ç½®ã€åŒºåŸŸï¼Œç¡®è®¤ã€Œæ¯ç›’ç“¶æ•°ã€è®¾ç½®æ­£ç¡®ï¼ˆé»˜è®¤6ç“¶ï¼‰</li>
            <li class="help-warn">âš  å¼€å§‹é‡‡é›†åä¸å¯ä¿®æ”¹</li>
          </ul>
          <div class="help-step-title">æ­¥éª¤2ï¼šå¼€å§‹é‡‡é›†</div>
          <ol class="help-ol">
            <li>ç‚¹å‡»ã€Œå¼€å§‹é‡‡é›†ã€æŒ‰é’®</li>
            <li>ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹è®¾å¤‡çŠ¶æ€ï¼ˆç“¶1è¯»ç å™¨ã€ç“¶2è¯»ç å™¨ã€ç›’è¯»ç å™¨ï¼‰</li>
            <li>æ£€æµ‹é€šè¿‡åå¼€å§‹é‡‡é›†ï¼›æŒ‰é’®å˜ä¸ºã€Œåœæ­¢é‡‡é›†ã€</li>
          </ol>
          <div class="help-step-title">æ­¥éª¤3ï¼šç›‘æ§é‡‡é›†è¿‡ç¨‹</div>
          <ul class="help-ul">
            <li><strong>å³ä¾§ä¸Šæ–¹ - ç›’ç è¯»ç åŒº</strong>ï¼šç»¿è‰²=å…³è”æˆåŠŸï¼Œçº¢è‰²=å…³è”å¤±è´¥æˆ–å¼‚å¸¸</li>
            <li><strong>å³ä¾§ä¸‹æ–¹ - ç“¶ç è¯»ç åŒº</strong>ï¼šé»‘è‰²=æ­£å¸¸ï¼Œçº¢è‰²=é‡ç /é”™ç ï¼ˆç³»ç»Ÿè‡ªåŠ¨æ ‡è®°ï¼Œäº§çº¿æ­£å¸¸ç§»åŠ¨ï¼Œä¸‹æ¸¸æŒ‰ç®±å‰”é™¤ï¼‰</li>
            <li><strong>å·¦ä¾§ - è®¡æ•°</strong>ï¼šã€Œåˆè®¡ç“¶æ•°ã€ã€Œå½“å‰ç›’æ•°ã€å®æ—¶æ›´æ–°</li>
          </ul>
          <div class="help-step-title">æ­¥éª¤4ï¼šåœæ­¢é‡‡é›†</div>
          <ul class="help-ul"><li>ç‚¹å‡»ã€Œåœæ­¢é‡‡é›†ã€æŒ‰é’®ï¼Œæœªæ»¡ç›’çš„æ•°æ®ä¼šä¿ç•™</li></ul>
          <div class="help-h2">2.2 è®¾å¤‡è¿æ¥çŠ¶æ€</div>
          <ul class="help-ul">
            <li>å·¦ä¾§ä¸‹æ–¹æ˜¾ç¤ºè¯»ç å™¨è¿æ¥çŠ¶æ€</li>
            <li>ç»¿è‰²æ–‡å­—ï¼šè®¾å¤‡å·²è¿æ¥ âœ“</li>
            <li>çº¢è‰²æ–‡å­—ï¼šè®¾å¤‡æœªè¿æ¥ï¼Œè¯·æ£€æŸ¥è®¾å¤‡è¿æ¥åé‡å¯</li>
          </ul>
          <div class="help-h2">2.3 æ¸…å±</div>
          <ul class="help-ul">
            <li>ç‚¹å‡»ã€Œæ¸…å±ã€æŒ‰é’®ï¼šæ¸…ç©ºè¯»ç åŒºæ˜¾ç¤ºè®°å½•</li>
            <li class="help-warn">âš  æ¸…å±ä¸å½±å“è®¡æ•°å’Œæ•°æ®åº“æ•°æ®</li>
          </ul>
        </div>

        <div class="help-section" id="h-m2">
          <div class="help-h1">ä¸‰ã€2å·æœºæ“ä½œæŒ‡å—ï¼ˆç›’ç®±å›å…³è”è½¯ä»¶ï¼‰</div>
          <div class="help-h2">3.1 åŠŸèƒ½å…¥å£</div>
          <table class="help-table">
            <thead><tr><th>Tab åç§°</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead>
            <tbody>
              <tr><td><strong>æ•°æ®é‡‡é›†</strong></td><td>ä¸»ç•Œé¢ï¼Œé»˜è®¤é€‰ä¸­</td></tr>
              <tr><td>æ‰‹å·¥é‡‡é›†</td><td>ç›¸æœºæŸåæ—¶å¤‡ç”¨</td></tr>
              <tr><td>ç åŒ…ç®¡ç†</td><td>å¯¼å…¥ç åŒ…æ•°æ®</td></tr>
              <tr><td>æ•°æ®æŸ¥è¯¢</td><td>æŸ¥è¯¢ç å…³è”å…³ç³»</td></tr>
              <tr><td>æ•°æ®æ›¿æ¢</td><td>ç æ›¿æ¢æ“ä½œ</td></tr>
              <tr><td>å–æ¶ˆå…³è”</td><td>å•ä¸ªæˆ–æ‰¹é‡è§£é™¤å…³è”</td></tr>
              <tr><td>ç”Ÿäº§ç»Ÿè®¡</td><td>æŸ¥çœ‹ç”Ÿäº§æ•°æ®ç»Ÿè®¡</td></tr>
              <tr><td>æ•°æ®ä¸Šä¼ </td><td>ç®¡ç†æ•°æ®ä¸Šä¼ çŠ¶æ€</td></tr>
            </tbody>
          </table>
          <p>ç³»ç»Ÿè®¾ç½®é€šè¿‡èœå•ã€Œé…ç½®ã€â†’ã€Œç³»ç»Ÿè®¾ç½®ã€è¿›å…¥ï¼ˆå¼¹çª—å½¢å¼ï¼Œéœ€è¦å¯†ç ï¼‰ã€‚</p>
          <div class="help-h2">3.2 æ•°æ®é‡‡é›†ä¸»ç•Œé¢æ“ä½œæµç¨‹</div>
          <div class="help-step-title">ç”Ÿäº§å‰å‡†å¤‡ï¼š</div>
          <ol class="help-ol">
            <li>ç‚¹å‡»ã€Œäº§å“é€‰æ‹©ã€ä¸‹æ‹‰æ¡†ï¼Œåœ¨å¼¹çª—ä¸­æœç´¢å¹¶é€‰æ‹©ç”Ÿäº§äº§å“</li>
            <li>ç¡®è®¤ç”Ÿäº§å•å·ï¼ˆç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œå¯æ‰‹åŠ¨ä¿®æ”¹ï¼‰</li>
            <li>ç¡®è®¤åŒ…è£…æ¯”ä¾‹ï¼ˆæ¯ç®±ç›’æ•°ã€æ¯å›ç®±æ•°ï¼‰</li>
          </ol>
          <div class="help-step-title">å¼€å§‹é‡‡é›†ï¼š</div>
          <ol class="help-ol">
            <li>ç‚¹å‡»å³ä¾§ã€Œå¼€å§‹é‡‡é›†ã€æŒ‰é’®</li>
            <li>ç³»ç»Ÿæ£€æµ‹è®¾å¤‡çŠ¶æ€ï¼Œæ£€æµ‹é€šè¿‡åå¼€å§‹é‡‡é›†</li>
            <li><strong>æŠ¥è­¦ç¯ç»¿ç¯å¸¸äº®</strong>ï¼Œè¡¨ç¤ºç³»ç»Ÿæ­£å¸¸å·¥ä½œ</li>
          </ol>
          <div class="help-step-title">ç›‘æ§é‡‡é›†è¿‡ç¨‹ï¼š</div>
          <ul class="help-ul">
            <li><strong>ä¸­é—´ä¸Šæ–¹ - æ•°æ®æ¥æ”¶åŒº</strong>ï¼ˆçº¦60%é«˜ï¼‰ï¼šæ‰«ç æ•°æ®å’Œå…³è”ç»“æœï¼Œæœ€æ–°åœ¨ä¸Š</li>
            <li><strong>ä¸­é—´ä¸­éƒ¨ - æ“ä½œæ—¥å¿—</strong>ï¼ˆçº¦20%ï¼‰ï¼šç”¨æˆ·æ“ä½œè®°å½•ï¼Œæœ€æ–°åœ¨ä¸Š</li>
            <li><strong>ä¸­é—´ä¸‹æ–¹ - æŠ¥è­¦ä¿¡æ¯</strong>ï¼ˆçº¦20%ï¼‰ï¼šé‡ç ã€å…³è”å¤±è´¥ç­‰å¼‚å¸¸ï¼Œæœ€æ–°åœ¨ä¸Š</li>
            <li><strong>å·¦ä¾§ - æ•°é‡ç»Ÿè®¡</strong>ï¼šä»¥ã€Œå®æ—¶æ•°/é¢„è®¾æ•°ã€å½¢å¼æ˜¾ç¤ºï¼ˆå¦‚ 4/4ã€6/70ï¼‰</li>
          </ul>
          <div class="help-step-title">æˆå›ä¸è‡ªåŠ¨ä¸Šä¼ ï¼š</div>
          <ul class="help-ul">
            <li>ç®±æ•°è¾¾åˆ°é¢„è®¾å€¼æ—¶è‡ªåŠ¨æˆå›ï¼Œæˆå›å<strong>è‡ªåŠ¨ä¸Šä¼ </strong>æ•°æ®è‡³äº‘ç«¯</li>
            <li>ä¸Šä¼ æˆåŠŸï¼šç»¿ç¯å¸¸äº® + å£°éŸ³æé†’</li>
            <li class="help-warn">ä¸Šä¼ å¤±è´¥ï¼šçº¢ç¯å¸¸äº® + å£°éŸ³æé†’ï¼ˆéœ€å¤„ç†åæ‰‹åŠ¨é‡ä¼ ï¼‰</li>
          </ul>
          <div class="help-h2">3.3 å³ä¾§æŒ‰é’®åŠŸèƒ½è¯´æ˜</div>
          <div class="help-step-title">é‡‡é›†æ§åˆ¶ç»„ï¼š</div>
          <table class="help-table">
            <thead><tr><th>æŒ‰é’®</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead>
            <tbody>
              <tr><td>å¼€å§‹/åœæ­¢é‡‡é›†</td><td>å¯åŠ¨æˆ–åœæ­¢æ•°æ®é‡‡é›†ï¼›åœæ­¢åæœªæ»¡å›æ•°æ®ä¿ç•™</td></tr>
              <tr><td>æ— éœ€é‡‡é›†ç </td><td>å½“å¤©ä¸ç”Ÿäº§äº”ç åˆä¸€äº§å“æ—¶å¼€å¯ï¼Œæ‰€æœ‰è¯»ç è®¾å¤‡ä¸å·¥ä½œ</td></tr>
              <tr><td>å…³é—­æŠ¥è­¦</td><td>ä¸Šä¼ å¤±è´¥è§¦å‘æŠ¥è­¦åï¼Œç‚¹å‡»å¯é‡ç½®æŠ¥è­¦çŠ¶æ€ï¼ˆåœæ­¢å£°å…‰æŠ¥è­¦å™¨ã€èœ‚é¸£å™¨ï¼‰</td></tr>
            </tbody>
          </table>
          <div class="help-step-title">å›ç›¸å…³æ“ä½œç»„ï¼š</div>
          <table class="help-table">
            <thead><tr><th>æŒ‰é’®</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead>
            <tbody>
              <tr><td>å¼ºåˆ¶æ»¡å›</td><td>æœªè¾¾åˆ°é¢„è®¾ç®±æ•°æ—¶ï¼Œå¼ºåˆ¶ç»“æŸå½“å‰å›ï¼Œç”Ÿæˆå›ç </td></tr>
              <tr><td>æ¸…ç©ºå›</td><td>æ¸…é™¤å½“å‰å›è®¡æ•°ï¼Œé‡ç½®ç»Ÿè®¡æ•°æ®</td></tr>
              <tr><td>æå–å·¥å•æœªæˆå›</td><td>æå–ä¹‹å‰æœªå®Œæˆå›çš„æ•°æ®ï¼ˆå¦‚éš”å¤©ç»§ç»­ç”Ÿäº§æ—¶ä½¿ç”¨ï¼‰ï¼Œå¼¹çª—é€‰æ‹©åæ¢å¤ç»§ç»­</td></tr>
            </tbody>
          </table>
          <div class="help-step-title">å‰”é™¤ç›¸å…³æ“ä½œç»„ï¼š</div>
          <table class="help-table">
            <thead><tr><th>æŒ‰é’®</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead>
            <tbody>
              <tr><td>æ”¶å›å‰”é™¤</td><td>å‰”é™¤è®¾å¤‡åŠ¨ä½œåæœªè‡ªåŠ¨æ”¶å›æ—¶ï¼Œç‚¹å‡»æ‰‹åŠ¨æ”¶å›</td></tr>
              <tr><td>æ€»å‰”é™¤æ•°</td><td>æ˜¾ç¤ºç´¯è®¡å‰”é™¤æ•°é‡</td></tr>
              <tr><td>æ¸…é›¶</td><td>å°†æ€»å‰”é™¤æ•°é‡ç½®ä¸º 0</td></tr>
            </tbody>
          </table>
        </div>

        <div class="help-section" id="h-funcs">
          <div class="help-h1">å››ã€å„åŠŸèƒ½æ“ä½œè¯´æ˜</div>
        </div>

        <div class="help-section" id="h-manual">
          <div class="help-h2">4.1 æ‰‹å·¥é‡‡é›†ï¼ˆç›¸æœºæŸåæ—¶ä½¿ç”¨ï¼‰</div>
          <ol class="help-ol">
            <li>ç‚¹å‡»ã€Œæ‰‹å·¥é‡‡é›†ã€Tab</li>
            <li>é€‰æ‹©å…³è”ç±»å‹ï¼šâ—‹ ç“¶ç›’å…³è” / â—‹ ç›’ç®±å…³è”</li>
            <li>è®¾ç½®åŒ…è£…æ¯”ä¾‹ï¼ˆæ¯ç“¶ç æ•° / æ¯ç›’ç æ•°ï¼Œæ ¹æ®é€‰æ‹©å˜åŒ–ï¼‰</li>
            <li>æŒ‰æç¤ºé¡ºåºç”¨æ‰«ç æªæ‰«ç ï¼š<br>â€” ç“¶ç›’æ¨¡å¼ï¼šå…ˆæ‰«ç“¶ç ï¼ˆè¶³å¤Ÿæ•°é‡åï¼‰â†’ æ‰«ç›’ç <br>â€” ç›’ç®±æ¨¡å¼ï¼šå…ˆæ‰«ç›’ç ï¼ˆè¶³å¤Ÿæ•°é‡åï¼‰â†’ æ‰«ç®±ç </li>
            <li>æ‰«ç å®Œæˆåè‡ªåŠ¨å…³è”ï¼Œå½“å‰å·²è¯»æ•°é‡å½’é›¶ï¼Œç»§ç»­ä¸‹ä¸€ç»„</li>
          </ol>
          <p class="help-warn">âš  æ³¨æ„ï¼šæ‰‹å·¥é‡‡é›†ä¸æ”¯æŒå›çº§å…³è”</p>
        </div>

        <div class="help-section" id="h-package">
          <div class="help-h2">4.2 ç åŒ…ç®¡ç†</div>
          <p><strong>ç”¨é€”</strong>ï¼šå¯¼å…¥åŒ…æå‚æä¾›çš„ç åŒ…æ–‡ä»¶ï¼Œç”¨äºé‡‡é›†æ—¶æ¯”å¯¹æ ¡éªŒï¼ˆä¸åœ¨ç åŒ…å†…çš„ç ä¼šè¢«å‰”é™¤ï¼‰ã€‚</p>
          <table class="help-table">
            <thead><tr><th>æ“ä½œ</th><th>æ­¥éª¤</th></tr></thead>
            <tbody>
              <tr><td>å¯åŠ¨æ—¶åœ¨çº¿å¯¼å…¥</td><td>è½¯ä»¶å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œï¼ŒåŒåç åŒ…è·³è¿‡ä¸é‡å¤å¯¼å…¥</td></tr>
              <tr><td>æœ¬åœ°å¯¼å…¥</td><td>ç‚¹å‡»ã€Œæœ¬åœ°å¯¼å…¥ã€â†’ é€‰æ‹© TXT æ ¼å¼ç åŒ…æ–‡ä»¶ â†’ ç³»ç»Ÿè§£æå…¥åº“</td></tr>
              <tr><td>åœ¨çº¿æ›´æ–°</td><td>ç‚¹å‡»ã€Œåœ¨çº¿æ›´æ–°ã€â†’ ä»åœ¨çº¿æºæ‹‰å–ç åŒ…ï¼ˆåŒåè·³è¿‡ï¼‰</td></tr>
              <tr><td>æŸ¥çœ‹ç åŒ…</td><td>ç‚¹å‡»æ“ä½œåˆ—ã€ŒæŸ¥çœ‹ã€â†’ å¼¹çª—æ˜¾ç¤ºè¯¥ç åŒ…æ‰€æœ‰ç ï¼Œæ”¯æŒæœç´¢</td></tr>
              <tr><td>åˆ é™¤ç åŒ…</td><td>ç‚¹å‡»æ“ä½œåˆ—ã€Œåˆ é™¤ã€â†’ ç¡®è®¤åæ ‡è®°ä¸ºå·²åˆ é™¤</td></tr>
            </tbody>
          </table>
        </div>

        <div class="help-section" id="h-query">
          <div class="help-h2">4.3 æ•°æ®æŸ¥è¯¢</div>
          <p><strong>ç”¨é€”</strong>ï¼šæŸ¥è¯¢ç çš„å…³è”å…³ç³»ï¼Œç”¨äºäº§å“è¿½æº¯ã€‚</p>
          <table class="help-table">
            <thead><tr><th>æŸ¥è¯¢ç±»å‹</th><th>æ“ä½œ</th><th>ç»“æœè¯´æ˜</th></tr></thead>
            <tbody>
              <tr><td>æ­£å‘æŸ¥è¯¢ï¼ˆæŸ¥ä¸‹çº§ï¼‰</td><td>è¾“å…¥ç  â†’ ç‚¹å‡»ã€Œæ­£å‘æŸ¥è¯¢ã€æˆ–å›è½¦</td><td>æ˜¾ç¤ºè¯¥ç çš„ç›´æ¥ä¸‹çº§ç ï¼šå›â†’ç®±ï¼Œç®±â†’ç›’ï¼Œç›’â†’ç“¶</td></tr>
              <tr><td>åå‘æŸ¥è¯¢ï¼ˆæŸ¥ä¸Šçº§ï¼‰</td><td>è¾“å…¥ç  â†’ ç‚¹å‡»ã€Œåå‘æŸ¥è¯¢ã€æˆ– Ctrl+Enter</td><td>æ˜¾ç¤ºè¯¥ç çš„æ‰€æœ‰ä¸Šçº§ç  + åŒçº§å…¶ä»–ç </td></tr>
            </tbody>
          </table>
        </div>

        <div class="help-section" id="h-replace">
          <div class="help-h2">4.4 æ•°æ®æ›¿æ¢ <span class="help-badge-warn">éœ€è¦å¯†ç  123456</span></div>
          <p><strong>ç”¨é€”</strong>ï¼šç æŸåæˆ–ç é”™è¯¯æ—¶ï¼Œå°†æ—§ç æ›¿æ¢ä¸ºæ–°ç ã€‚</p>
          <ol class="help-ol">
            <li>è¾“å…¥åŸç ï¼ˆå¾…æ›¿æ¢ï¼‰</li>
            <li>è¾“å…¥æ–°ç ï¼ˆæ›¿æ¢åï¼‰</li>
            <li>è¾“å…¥æ›¿æ¢åŸå› ï¼ˆå¯é€‰ï¼‰</li>
            <li>ç‚¹å‡»ã€Œç¡®è®¤æ›¿æ¢ã€â†’ å¼¹çª—æ ¸å¯¹ä¿¡æ¯ â†’ è¾“å…¥å¯†ç  <strong>123456</strong> â†’ ç¡®è®¤æ‰§è¡Œ</li>
          </ol>
          <p><strong>æ–°ç è¦æ±‚ï¼ˆéœ€åŒæ—¶æ»¡è¶³ï¼‰ï¼š</strong></p>
          <ul class="help-ul">
            <li>âœ… åœ¨å¯¼å…¥çš„ç åŒ…èŒƒå›´å†…</li>
            <li>âœ… æœªè¢«ä½¿ç”¨è¿‡ï¼ˆç³»ç»Ÿä¸­æ— å…³è”å…³ç³»ï¼‰</li>
            <li>âœ… æ ¼å¼æœ‰æ•ˆï¼Œä¸”ä¸èƒ½ä¸åŸç ç›¸åŒ</li>
          </ul>
          <p class="help-warn">âš  æ›¿æ¢æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·åŠ¡å¿…æ ¸å¯¹æ— è¯¯å†æ‰§è¡Œ</p>
        </div>

        <div class="help-section" id="h-cancel">
          <div class="help-h2">4.5 å–æ¶ˆå…³è” <span class="help-badge-warn">éœ€è¦å¯†ç  123456</span></div>
          <p><strong>ç”¨é€”</strong>ï¼šè§£é™¤ç çš„å…³è”å…³ç³»ï¼ˆå¦‚æ•°æ®é”™è¯¯ã€äº§å“éœ€è¦é‡æ–°å¤„ç†æ—¶ï¼‰ã€‚</p>
          <div class="help-info-box">
            <strong>é‡è¦è§„åˆ™ï¼š</strong>
            <ul class="help-ul" style="margin-top:6px;">
              <li>å¿…é¡»<strong>ä»å¤§åˆ°å°é€çº§è§£é™¤</strong>ï¼ˆå› â†’ ç®± â†’ ç›’ â†’ ç“¶ï¼‰ï¼Œä¸å¯ä¸€æ¬¡æ€§è§£é™¤å…¨éƒ¨</li>
              <li>ç³»ç»Ÿè‡ªåŠ¨æ£€æŸ¥ä¸Šçº§å…³è”çŠ¶æ€ï¼Œæœ‰ä¸Šçº§æ—¶ã€Œç¡®è®¤ã€æŒ‰é’®ç¦ç”¨ï¼Œæç¤ºå…ˆè§£é™¤ä¸Šçº§</li>
              <li>ç³»ç»Ÿè‡ªåŠ¨æ£€æŸ¥äº‘ç«¯æ•°æ®å¹¶å…ˆè§£é™¤äº‘ç«¯å…³è”ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´</li>
            </ul>
          </div>
          <div class="help-step-title">å•ä¸ªå–æ¶ˆå…³è”æ“ä½œæ­¥éª¤ï¼š</div>
          <ol class="help-ol">
            <li>é€‰æ‹©ã€Œå•ä¸ªå–æ¶ˆå…³è”ã€æ¨¡å¼</li>
            <li>è¾“å…¥åŒä¸€åŒ…è£…å†…çš„ä»»æ„ä¸¤ä¸ªç </li>
            <li>ç‚¹å‡»ã€Œè¯†åˆ«ã€â†’ å³ä¾§æ˜¾ç¤ºè¯†åˆ«ç»“æœï¼ˆå«ä¸Šçº§å…³è”é“¾è·¯ï¼‰</li>
            <li>å¦‚æœ‰ä¸Šçº§å…³è”ï¼Œå…ˆä»å›å¼€å§‹é€çº§è§£é™¤ä¸Šçº§ï¼Œå†å›æ¥è§£é™¤å½“å‰çº§</li>
            <li>æ— ä¸Šçº§å…³è”åï¼Œç‚¹å‡»ã€Œç¡®è®¤å–æ¶ˆå…³è”ã€â†’ è¾“å…¥å¯†ç  <strong>123456</strong> â†’ ç¡®è®¤æ‰§è¡Œ</li>
          </ol>
          <div class="help-step-title">æ‰¹é‡å–æ¶ˆå…³è”æ“ä½œæ­¥éª¤ï¼š</div>
          <ol class="help-ol">
            <li>é€‰æ‹©ã€Œæ‰¹é‡å–æ¶ˆå…³è”ã€æ¨¡å¼</li>
            <li>é€ä¸€è¾“å…¥å¤§ç ï¼ˆç›’ç /ç®±ç /å›ç ï¼‰â†’ ç‚¹å‡»ã€Œæ·»åŠ ã€</li>
            <li>ç‚¹å‡»ã€Œè¯†åˆ«ã€â†’ å³ä¾§æ˜¾ç¤ºæ‰€æœ‰åŒ…è£…å•å…ƒçš„è¯†åˆ«ç»“æœ</li>
            <li>å¤„ç†æœ‰ä¸Šçº§å…³è”çš„å•å…ƒåï¼Œç‚¹å‡»ã€Œç¡®è®¤æ‰¹é‡å–æ¶ˆå…³è”ã€â†’ è¾“å…¥å¯†ç  <strong>123456</strong> â†’ æ‰§è¡Œ</li>
          </ol>
          <p class="help-warn">âš  æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·ç¡®è®¤æ— è¯¯åæ“ä½œ</p>
        </div>

        <div class="help-section" id="h-stats">
          <div class="help-h2">4.6 ç”Ÿäº§ç»Ÿè®¡</div>
          <p><strong>ç”¨é€”</strong>ï¼šæŸ¥çœ‹ç”Ÿäº§æ•°æ®ç»Ÿè®¡å’Œå„å›ä¸Šä¼ çŠ¶æ€ã€‚</p>
          <table class="help-table">
            <thead><tr><th>æ“ä½œ</th><th>æ­¥éª¤</th></tr></thead>
            <tbody>
              <tr><td>ç”Ÿäº§ç»Ÿè®¡æŸ¥è¯¢</td><td>å·¦ä¾§é€‰æ‹©æ—¥æœŸèŒƒå›´ â†’ ç‚¹å‡»ã€ŒæŸ¥è¯¢ã€â†’ æ˜¾ç¤ºå›æ•°/ç®±æ•°/ç›’æ•°</td></tr>
              <tr><td>æŸ¥çœ‹å›ç åˆ—è¡¨</td><td>ç‚¹å‡»è“è‰²ä¸‹åˆ’çº¿çš„ã€Œå›æ•°ã€æ•°å­— â†’ å¼¹çª—æ˜¾ç¤ºå›ç åˆ—è¡¨ï¼Œæ”¯æŒæ¨¡ç³Šç­›é€‰</td></tr>
              <tr><td>ä¸Šä¼ ç»Ÿè®¡æŸ¥è¯¢</td><td>å³ä¾§é€‰æ‹©æ—¥æœŸèŒƒå›´å’ŒçŠ¶æ€ï¼ˆå…¨éƒ¨/æˆåŠŸ/å¼‚å¸¸ï¼‰â†’ ç‚¹å‡»ã€ŒæŸ¥è¯¢ã€</td></tr>
            </tbody>
          </table>
        </div>

        <div class="help-section" id="h-upload">
          <div class="help-h2">4.7 æ•°æ®ä¸Šä¼ </div>
          <p><strong>ç”¨é€”</strong>ï¼šç®¡ç†ä¸Šä¼ ä»»åŠ¡å’ŒçŠ¶æ€ï¼Œå¤„ç†ä¸Šä¼ å¼‚å¸¸ã€‚</p>
          <table class="help-table">
            <thead><tr><th>åŠŸèƒ½</th><th>æ“ä½œ</th></tr></thead>
            <tbody>
              <tr><td>æ‰‹åŠ¨ä¸Šä¼ </td><td>ç‚¹å‡»ã€Œæ‰‹åŠ¨ä¸Šä¼ ã€â†’ æ‰¹é‡ä¸Šä¼ æ‰€æœ‰æœªä¸Šä¼ çš„å›</td></tr>
              <tr><td>æŸ¥è¯¢çŠ¶æ€</td><td>è¾“å…¥å›ç  â†’ ç‚¹å‡»ã€ŒæŸ¥è¯¢çŠ¶æ€ã€â†’ æŸ¥çœ‹ä¸Šä¼ è¯¦æƒ…</td></tr>
              <tr><td>è®¾ä¸ºæœªä¸Šä¼ </td><td>è¾“å…¥å›ç  â†’ ç‚¹å‡»ã€Œè®¾ä¸ºæœªä¸Šä¼ ã€â†’ ç¡®è®¤ï¼ˆç”¨äºå¼‚å¸¸ä¿®å¤åé‡æ–°è¡¥ä¼ ï¼‰</td></tr>
              <tr><td>è®¾ä¸ºå·²ä¸Šä¼ </td><td>è¾“å…¥å›ç  â†’ ç‚¹å‡»ã€Œè®¾ä¸ºå·²ä¸Šä¼ ã€â†’ ç¡®è®¤ï¼ˆé¿å…ç³»ç»Ÿé‡å¤ä¸Šä¼ ï¼‰</td></tr>
            </tbody>
          </table>
          <p>å·¦ä¾§ã€Œä¸Šä¼ ä¿¡æ¯å±•ç¤ºåŒºã€å®æ—¶æ˜¾ç¤ºè‡ªåŠ¨ä¸Šä¼ æ—¥å¿—ï¼š</p>
          <ul class="help-ul">
            <li><span style="color:#9CA3AF;">â– </span> ç°è‰²ï¼šå¼€å§‹ä¸Šä¼ </li>
            <li><span style="color:#2563EB;">â– </span> è“è‰²ï¼šä¸Šä¼ ä¸­</li>
            <li><span style="color:#16A34A;">â– </span> ç»¿è‰²ï¼šä¸Šä¼ æˆåŠŸ</li>
            <li><span style="color:#DC2626;">â– </span> çº¢è‰²ï¼šä¸Šä¼ å¤±è´¥ï¼ˆå«å¤±è´¥åŸå› ï¼‰</li>
          </ul>
        </div>

        <div class="help-section" id="h-faq">
          <div class="help-h1">äº”ã€å¸¸è§é—®é¢˜ &amp; å¼‚å¸¸å¤„ç†</div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q1ï¼š1å·æœºæ˜¾ç¤ºçº¢è‰²ç ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</div>
            <div class="help-faq-a">çº¢è‰²ç  = é‡ç ï¼ˆå·²å­˜åœ¨ï¼‰æˆ–é”™ç ï¼ˆæ ¼å¼é”™è¯¯ï¼‰ã€‚ç³»ç»Ÿè‡ªåŠ¨æ ‡è®°å¾…å‰”é™¤ï¼Œäº§çº¿æ­£å¸¸ç§»åŠ¨ï¼Œä¸‹æ¸¸é¾™é—¨æ¶æŒ‰ç®±å‰”é™¤ï¼Œ<strong>æ— éœ€æ‰‹åŠ¨å¹²é¢„</strong>ã€‚</div>
          </div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q2ï¼šè®¾å¤‡æ˜¾ç¤ºæœªè¿æ¥æ€ä¹ˆåŠï¼Ÿ</div>
            <ol class="help-ol">
              <li>æ£€æŸ¥è¯»ç å™¨/ç›¸æœºçš„ç”µæºå’Œç½‘çº¿æ˜¯å¦æ’å¥½</li>
              <li>é‡å¯è®¾å¤‡åï¼ŒæŸ¥çœ‹è¿æ¥çŠ¶æ€æ˜¯å¦æ¢å¤ç»¿è‰²</li>
              <li>è‹¥ä»æœªè¿æ¥ï¼Œè”ç³»æŠ€æœ¯äººå‘˜</li>
            </ol>
          </div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q3ï¼šæ•°æ®ä¸Šä¼ å¤±è´¥ï¼Œçº¢ç¯äº®äº†æ€ä¹ˆåŠï¼Ÿ</div>
            <ol class="help-ol">
              <li>æŸ¥çœ‹ã€Œæ•°æ®ä¸Šä¼ ã€Tab ä¸­çš„å¤±è´¥åŸå› </li>
              <li>æ ¹æ®å¤±è´¥åŸå› è¿›è¡Œæ•°æ®å¤„ç†æˆ–ç­‰å¾…ç½‘ç»œæ¢å¤</li>
              <li>ç‚¹å‡»ã€Œå…³é—­æŠ¥è­¦ã€é‡ç½®æŠ¥è­¦ç¯å’Œèœ‚é¸£å™¨</li>
              <li>å¤„ç†å®Œæˆåï¼Œç‚¹å‡»ã€Œæ‰‹åŠ¨ä¸Šä¼ ã€é‡æ–°ä¸Šä¼ </li>
            </ol>
          </div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q4ï¼šç”Ÿäº§ç»“æŸæ—¶è¿˜æœ‰å°¾æ•°ï¼ˆæœªæ»¡å›ï¼‰ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</div>
            <div class="help-faq-a">
              <strong>æ–¹å¼ä¸€ï¼ˆæ¨èï¼‰</strong>ï¼šç‚¹å‡»ã€Œå¼ºåˆ¶æ»¡å›ã€ï¼Œå°†å½“å‰æ•°æ®å¼ºåˆ¶æˆå›å¹¶ä¸Šä¼ <br>
              <strong>æ–¹å¼äºŒ</strong>ï¼šç›´æ¥åœæ­¢é‡‡é›†ï¼Œä¸åšå¤„ç†ã€‚ä¸‹æ¬¡ç”Ÿäº§æ—¶ç‚¹å‡»ã€Œæå–å·¥å•æœªæˆå›ã€ï¼Œé€‰æ‹©è¯¥æ¡æ•°æ®ç»§ç»­ç”Ÿäº§
            </div>
          </div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q5ï¼šå‰”é™¤è£…ç½®å‰”å‡ºå»åæ²¡æœ‰è‡ªåŠ¨æ”¶å›ï¼Œæ€ä¹ˆåŠï¼Ÿ</div>
            <div class="help-faq-a">ç‚¹å‡»å³ä¾§ã€Œæ”¶å›å‰”é™¤ã€æŒ‰é’®ï¼Œæ‰‹åŠ¨è§¦å‘æ”¶å›æŒ‡ä»¤ã€‚</div>
          </div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q6ï¼šå¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ</div>
            <div class="help-faq-a">ç³»ç»Ÿè®¾ç½®ã€ç æ›¿æ¢ã€å–æ¶ˆå…³è”çš„å¯†ç ç»Ÿä¸€ä¸ºï¼š<strong style="color:#2563EB; font-size:18px;">123456</strong></div>
          </div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q7ï¼šå¦‚ä½•çŸ¥é“ç å±äºå“ªä¸€å±‚çº§ï¼ˆç“¶/ç›’/ç®±/å›ï¼‰ï¼Ÿ</div>
            <div class="help-faq-a">åœ¨ã€Œæ•°æ®æŸ¥è¯¢ã€Tab ä¸­è¾“å…¥ç å€¼ï¼Œç‚¹å‡»ã€Œæ­£å‘æŸ¥è¯¢ã€æˆ–ã€Œåå‘æŸ¥è¯¢ã€ï¼ŒæŸ¥è¯¢ç»“æœä¼šæ˜¾ç¤ºè¯¥ç çš„å±‚çº§å’Œå…³è”å…³ç³»ã€‚</div>
          </div>
          <div class="help-faq-item">
            <div class="help-faq-q">Q8ï¼šå–æ¶ˆå…³è”æ—¶æç¤ºã€Œè¯·å…ˆè§£é™¤ä¸Šçº§ã€ï¼Œæ€ä¹ˆæ“ä½œï¼Ÿ</div>
            <ol class="help-ol">
              <li>åœ¨ã€Œè¯†åˆ«ç»“æœã€ä¸­æŸ¥çœ‹å®Œæ•´é“¾è·¯ï¼ˆå¦‚ï¼šå›ç xxx â†’ ç®±ç xxx â†’ ç›’ç xxxï¼‰</li>
              <li>å…ˆè¾“å…¥æœ€é¡¶å±‚çš„å›ç ï¼Œæ‰§è¡Œå–æ¶ˆå…³è”</li>
              <li>å†è¾“å…¥ç®±ç ï¼Œæ‰§è¡Œå–æ¶ˆå…³è”</li>
              <li>æœ€åè¾“å…¥ç›’ç ï¼Œæ‰§è¡Œå–æ¶ˆå…³è”</li>
              <li>æ¯æ¬¡è§£é™¤éƒ½éœ€è¦è¾“å…¥å¯†ç  123456</li>
            </ol>
          </div>
        </div>

        <div class="help-section" id="h-notes">
          <div class="help-h1">å…­ã€æ³¨æ„äº‹é¡¹</div>
          <div class="help-info-box">
            <ol class="help-ol" style="margin:0;">
              <li><strong>å¯†ç ä¿æŠ¤</strong>ï¼šç³»ç»Ÿè®¾ç½®ã€ç æ›¿æ¢ã€å–æ¶ˆå…³è”å‡éœ€è¦å¯†ç  <strong>123456</strong>ï¼Œè¯·å¦¥å–„ä¿ç®¡</li>
              <li><strong>ä¸å¯æ¢å¤æ“ä½œ</strong>ï¼šç æ›¿æ¢ã€å–æ¶ˆå…³è”æ‰§è¡Œå<strong>æ— æ³•æ’¤é”€</strong>ï¼Œæ“ä½œå‰è¯·ä»”ç»†æ ¸å¯¹</li>
              <li><strong>åŒ…è£…æ¯”ä¾‹</strong>ï¼šä¸å¯éšæ„ä¿®æ”¹ï¼Œå¦‚éœ€å˜æ›´è¯·è”ç³»ç®¡ç†å‘˜</li>
              <li><strong>ç”Ÿäº§å‰æ£€æŸ¥</strong>ï¼šæ¯æ¬¡å¼€å§‹ç”Ÿäº§å‰ï¼Œç¡®è®¤ç åŒ…å·²å¯¼å…¥ã€è®¾å¤‡è¿æ¥æ­£å¸¸</li>
              <li><strong>å¼‚å¸¸ä¼˜å…ˆå¤„ç†</strong>ï¼šå‘ç°æŠ¥è­¦ä¿¡æ¯ï¼ˆä¸­é—´ä¸‹æ–¹çº¢è‰²åŒºåŸŸï¼‰åº”åŠæ—¶å¤„ç†ï¼Œé¿å…å½±å“æ•°æ®å‡†ç¡®æ€§</li>
            </ol>
          </div>
        </div>

      </div><!-- /helpContent -->
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" style="height:40px; padding:0 24px;" onclick="closeHelpModal()">å…³é—­</button>
    </div>
  </div>
</div>

<!-- å¯†ç å¼¹çª— -->
<div class="modal-overlay" id="pwdOverlay" onclick="if(event.target===this)closePwd()">
  <div class="pwd-box" onclick="event.stopPropagation()">
    <div class="pwd-title">ğŸ”’ è¯·è¾“å…¥ç³»ç»Ÿå¯†ç </div>
    <input type="password" class="pwd-input" id="pwdInput" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" maxlength="12" onkeydown="if(event.key==='Enter')verifyPwd()">
    <div class="pwd-error" id="pwdError"></div>
    <div style="display:flex; gap:12px;">
      <button class="btn btn-secondary" style="flex:1; height:44px; font-size:15px;" onclick="closePwd()">å–æ¶ˆ</button>
      <button class="btn btn-primary" style="flex:1; height:44px; font-size:15px;" onclick="verifyPwd()">ç¡®è®¤</button>
    </div>
  </div>
</div>

<!-- ç³»ç»Ÿè®¾ç½®å¼¹çª— -->
<div class="modal-overlay" id="sysOverlay" onclick="if(event.target===this)closeSys()">
  <div class="modal-box" style="width:860px; max-height:680px;" onclick="event.stopPropagation()">
    <div class="modal-header">
      <span class="modal-title">ç³»ç»Ÿè®¾ç½®ï¼ˆ2å·æœºï¼‰</span>
      <button class="modal-close-btn" onclick="closeSys()">âœ•</button>
    </div>
    <div class="sys-tab-bar">
      <div class="sys-tab active" onclick="switchSysTab2(this,'st-io')">IOè®¾å¤‡ç®¡ç†</div>
      <div class="sys-tab" onclick="switchSysTab2(this,'st-printer')">æ‰“å°æœºç®¡ç†</div>
      <div class="sys-tab" onclick="switchSysTab2(this,'st-alarm')">æŠ¥è­¦è®¾ç½®</div>
      <div class="sys-tab" onclick="switchSysTab2(this,'st-db')">æ•°æ®åº“è¿æ¥</div>
    </div>
    <div style="flex:1; overflow:hidden; display:flex; flex-direction:column;">
      <div class="sys-tab-panel active" id="st-io" style="flex:1;">
        <div style="margin-bottom:10px;"><button class="btn btn-primary" style="height:36px; padding:0 16px; font-size:13px;" onclick="alert('æ·»åŠ è®¾å¤‡')">+ æ·»åŠ è®¾å¤‡</button></div>
        <table class="device-table">
          <thead><tr><th>è®¾å¤‡åç§°</th><th>è®¾å¤‡ç±»å‹</th><th>è¿æ¥åœ°å€</th><th>ç«¯å£</th><th>çŠ¶æ€</th><th>æ“ä½œ</th></tr></thead>
          <tbody>
            <tr><td>ç›’ç ç›¸æœº</td><td>ç½‘ç»œç›¸æœº</td><td>192.168.1.104</td><td>3000</td><td><span class="badge badge-green">å·²è¿æ¥</span></td><td style="display:flex;gap:6px;"><button class="btn-sm btn-sm-blue">ç¼–è¾‘</button><button class="btn-sm btn-sm-green" onclick="alert('è¿æ¥æµ‹è¯•æˆåŠŸ')">æµ‹è¯•</button><button class="btn-sm btn-sm-red" onclick="alert('ç¡®è®¤åˆ é™¤ï¼Ÿ')">åˆ é™¤</button></td></tr>
            <tr><td>ç®±ç ç›¸æœº</td><td>ç½‘ç»œç›¸æœº</td><td>192.168.1.105</td><td>3000</td><td><span class="badge badge-green">å·²è¿æ¥</span></td><td style="display:flex;gap:6px;"><button class="btn-sm btn-sm-blue">ç¼–è¾‘</button><button class="btn-sm btn-sm-green" onclick="alert('è¿æ¥æµ‹è¯•æˆåŠŸ')">æµ‹è¯•</button><button class="btn-sm btn-sm-red" onclick="alert('ç¡®è®¤åˆ é™¤ï¼Ÿ')">åˆ é™¤</button></td></tr>
            <tr><td>å‰”é™¤è£…ç½®</td><td>ä¸²å£RS485</td><td>COM4</td><td>9600</td><td><span class="badge badge-green">å·²è¿æ¥</span></td><td style="display:flex;gap:6px;"><button class="btn-sm btn-sm-blue">ç¼–è¾‘</button><button class="btn-sm btn-sm-green" onclick="alert('è¿æ¥æµ‹è¯•æˆåŠŸ')">æµ‹è¯•</button><button class="btn-sm btn-sm-red" onclick="alert('ç¡®è®¤åˆ é™¤ï¼Ÿ')">åˆ é™¤</button></td></tr>
            <tr><td>æŠ¥è­¦ç¯</td><td>ç½‘ç»œTCP/IP</td><td>192.168.1.150</td><td>5020</td><td><span class="badge badge-green">å·²è¿æ¥</span></td><td style="display:flex;gap:6px;"><button class="btn-sm btn-sm-blue">ç¼–è¾‘</button><button class="btn-sm btn-sm-green" onclick="alert('è¿æ¥æµ‹è¯•æˆåŠŸ')">æµ‹è¯•</button><button class="btn-sm btn-sm-red" onclick="alert('ç¡®è®¤åˆ é™¤ï¼Ÿ')">åˆ é™¤</button></td></tr>
            <tr><td>æŒ‡ç¤ºç¯</td><td>ç½‘ç»œTCP/IP</td><td>192.168.1.151</td><td>5020</td><td><span class="badge badge-red">æœªè¿æ¥</span></td><td style="display:flex;gap:6px;"><button class="btn-sm btn-sm-blue">ç¼–è¾‘</button><button class="btn-sm btn-sm-green" onclick="alert('è¿æ¥æµ‹è¯•å¤±è´¥ï¼šè®¾å¤‡æœªå“åº”')">æµ‹è¯•</button><button class="btn-sm btn-sm-red" onclick="alert('ç¡®è®¤åˆ é™¤ï¼Ÿ')">åˆ é™¤</button></td></tr>
          </tbody>
        </table>
      </div>
      <div class="sys-tab-panel" id="st-printer">
        <div class="form-row"><span class="form-label" style="width:120px;">æ‰“å°æœºåç§°</span><input type="text" class="form-input" value="Canon LBP2900" style="flex:1;"></div>
        <div class="form-row"><span class="form-label" style="width:120px;">æ‰“å°æœºIP</span><input type="text" class="form-input" value="192.168.1.201" style="flex:1;"></div>
        <div class="form-row"><span class="form-label" style="width:120px;">æ‰“å°ç«¯å£</span><input type="number" class="form-input" value="9100" style="flex:1;"></div>
        <button class="btn btn-primary" style="height:36px; padding:0 16px; font-size:13px;" onclick="alert('æ‰“å°æœºè®¾ç½®å·²ä¿å­˜')">ä¿å­˜</button>
      </div>
      <div class="sys-tab-panel" id="st-alarm">
        <div class="form-row" style="margin-bottom:16px;"><span class="form-label" style="width:120px;">å£°éŸ³æŠ¥è­¦</span><div class="toggle-track on" onclick="this.classList.toggle('on')"><div class="toggle-thumb"></div></div></div>
        <div class="form-row"><span class="form-label" style="width:120px;">æŠ¥è­¦å»¶æ—¶(ms)</span><input type="number" class="form-input" value="500" style="flex:1;"></div>
        <div class="form-row"><span class="form-label" style="width:120px;">æŠ¥è­¦é—´éš”(ms)</span><input type="number" class="form-input" value="2000" style="flex:1;"></div>
        <div style="display:flex; gap:10px; margin-top:10px;">
          <button class="btn btn-warning" style="height:36px; padding:0 16px; font-size:13px;" onclick="alert('æµ‹è¯•æŠ¥è­¦å·²è§¦å‘')">æµ‹è¯•æŠ¥è­¦</button>
          <button class="btn btn-primary" style="height:36px; padding:0 16px; font-size:13px;" onclick="alert('æŠ¥è­¦è®¾ç½®å·²ä¿å­˜')">ä¿å­˜</button>
        </div>
      </div>
      <div class="sys-tab-panel" id="st-db">
        <div style="background:#FEF3C7; border:1px solid #FCD34D; border-radius:8px; padding:10px 14px; margin-bottom:14px; font-size:13px; color:#92400E;">
          âš  2å·æœºéƒ¨ç½²æ•°æ®åº“ï¼Œ1å·æœºé€šè¿‡å±€åŸŸç½‘è®¿é—®æ­¤åº“ï¼Œè¯·æ­£ç¡®é…ç½®æ•°æ®åº“ä¿¡æ¯
        </div>
        <div class="form-row"><span class="form-label" style="width:120px;">æ•°æ®åº“åœ°å€</span><input type="text" class="form-input" value="192.168.1.200" style="flex:1;"></div>
        <div class="form-row"><span class="form-label" style="width:120px;">æ•°æ®åº“ç«¯å£</span><input type="number" class="form-input" value="3306" style="flex:1;"></div>
        <div class="form-row"><span class="form-label" style="width:120px;">æ•°æ®åº“å</span><input type="text" class="form-input" value="production_db" style="flex:1;"></div>
        <div class="form-row"><span class="form-label" style="width:120px;">ç”¨æˆ·å</span><input type="text" class="form-input" value="admin" style="flex:1;"></div>
        <div class="form-row"><span class="form-label" style="width:120px;">å¯†ç </span><input type="password" class="form-input" value="123456" style="flex:1;"></div>
        <div style="display:flex; gap:10px; align-items:center;">
          <button class="btn btn-secondary" style="height:36px; padding:0 16px; font-size:13px;" onclick="testDbConn2()">è¿æ¥æµ‹è¯•</button>
          <button class="btn btn-primary" style="height:36px; padding:0 16px; font-size:13px;" onclick="alert('æ•°æ®åº“é…ç½®å·²ä¿å­˜')">ä¿å­˜</button>
          <span id="dbTestResult2" style="font-size:13px;"></span>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" style="height:36px; padding:0 16px; font-size:13px;" onclick="closeSys()">å…³é—­</button>
    </div>
  </div>
</div>

<!-- ç¡®è®¤å¼¹çª—ï¼ˆé€šç”¨ï¼‰ -->
<div class="modal-overlay" id="confirmOverlay" onclick="if(event.target===this)closeConfirm()">
  <div class="confirm-box" onclick="event.stopPropagation()">
    <div style="font-size:18px; font-weight:700; color:#1F2937; margin-bottom:16px;" id="confirmTitle">ç¡®è®¤æ“ä½œ</div>
    <div style="font-size:14px; color:#374151; margin-bottom:16px; background:#F9FAFB; border-radius:8px; padding:14px; line-height:1.8;" id="confirmMsg">ç¡®è®¤æ‰§è¡Œæ­¤æ“ä½œï¼Ÿ</div>
    <div style="margin-bottom:14px;">
      <div style="font-size:14px; font-weight:600; color:#DC2626; margin-bottom:6px;">* è¯·è¾“å…¥å¯†ç </div>
      <input type="password" class="form-input" id="confirmPwd" placeholder="è¯·è¾“å…¥å¯†ç " style="width:100%;">
      <div style="color:#DC2626; font-size:13px; min-height:18px; margin-top:4px;" id="confirmPwdErr"></div>
    </div>
    <div style="color:#DC2626; font-size:14px; font-weight:600; margin-bottom:16px;">âš  æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·ä»”ç»†æ ¸å¯¹åç¡®è®¤ï¼</div>
    <div style="display:flex; gap:12px; justify-content:flex-end;">
      <button class="btn btn-secondary" style="height:44px; width:80px; font-size:14px;" onclick="closeConfirm()">å–æ¶ˆ</button>
      <button class="btn btn-danger" style="height:44px; width:120px; font-size:14px;" id="confirmOkBtn" onclick="execConfirm()">ç¡®è®¤</button>
    </div>
  </div>
</div>

<!-- ç åŒ…æŸ¥çœ‹å¼¹çª— -->
<div class="modal-overlay" id="packageOverlay" onclick="if(event.target===this)closePackage()">
  <div class="modal-box" style="width:700px; max-height:600px;" onclick="event.stopPropagation()">
    <div class="modal-header">
      <span class="modal-title" id="packageModalTitle">æŸ¥çœ‹ç åŒ…</span>
      <button class="modal-close-btn" onclick="closePackage()">âœ•</button>
    </div>
    <div class="modal-body" style="padding:16px;">
      <div style="display:flex; gap:8px; margin-bottom:12px;">
        <input type="text" class="form-input" placeholder="è¯·è¾“å…¥ç è¿›è¡Œæœç´¢..." style="flex:1;">
        <button class="btn btn-primary" style="height:40px; padding:0 16px; font-size:14px;">æœç´¢</button>
      </div>
      <table class="data-table">
        <thead><tr><th style="width:60px;">åºå·</th><th>ç å€¼</th><th>å¯¼å…¥æ—¶é—´</th></tr></thead>
        <tbody id="packageTableBody"></tbody>
      </table>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" style="height:36px; padding:0 16px; font-size:13px;" onclick="closePackage()">å…³é—­</button>
    </div>
  </div>
</div>

<!-- å›ç åˆ—è¡¨å¼¹çª— -->
<div class="modal-overlay" id="palletListOverlay" onclick="if(event.target===this)closePalletList()">
  <div class="modal-box" style="width:800px; max-height:650px;" onclick="event.stopPropagation()">
    <div class="modal-header">
      <span class="modal-title">å›ç åˆ—è¡¨</span>
      <button class="modal-close-btn" onclick="closePalletList()">âœ•</button>
    </div>
    <div class="modal-body" style="padding:16px;">
      <div style="display:flex; gap:8px; margin-bottom:12px;">
        <input type="text" class="form-input" placeholder="è¯·è¾“å…¥å›ç " style="width:250px;">
        <button class="btn btn-primary" style="height:40px; padding:0 16px; font-size:14px;">ç­›é€‰</button>
        <button class="btn btn-outline" style="height:40px; padding:0 16px; font-size:14px;">é‡ç½®</button>
      </div>
      <table class="data-table">
        <thead><tr><th>å›ç </th><th>å…³è”æ—¶é—´</th></tr></thead>
        <tbody>
          <tr><td>P20241201010</td><td>2024-12-01 16:30:22</td></tr>
          <tr class="row-even"><td>P20241201009</td><td>2024-12-01 15:55:10</td></tr>
          <tr><td>P20241201008</td><td>2024-12-01 15:20:45</td></tr>
          <tr class="row-even"><td>P20241201007</td><td>2024-12-01 14:45:33</td></tr>
          <tr><td>P20241201006</td><td>2024-12-01 14:10:18</td></tr>
          <tr class="row-even"><td>P20241201005</td><td>2024-12-01 13:35:02</td></tr>
          <tr><td>P20241201004</td><td>2024-12-01 13:00:55</td></tr>
          <tr class="row-even"><td>P20241201003</td><td>2024-12-01 12:25:40</td></tr>
          <tr><td>P20241201002</td><td>2024-12-01 11:50:28</td></tr>
          <tr class="row-even"><td>P20241201001</td><td>2024-12-01 11:15:16</td></tr>
        </tbody>
      </table>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" style="height:36px; padding:0 16px; font-size:13px;" onclick="closePalletList()">å…³é—­</button>
    </div>
  </div>
</div>

<!-- å¸®åŠ©å¼¹çª— -->
<div class="help-popup" id="helpPopup" onclick="event.stopPropagation()"></div>

<script>
// æ—¶é’Ÿ
function updateTime() {
  const now = new Date();
  const s = d => String(d).padStart(2,'0');
  const t = `${now.getFullYear()}-${s(now.getMonth()+1)}-${s(now.getDate())} ${s(now.getHours())}:${s(now.getMinutes())}:${s(now.getSeconds())}`;
  document.getElementById('currentTime2').textContent = t;
}
updateTime(); setInterval(updateTime, 1000);

// æ ¹æ®URL hashè‡ªåŠ¨è·³è½¬åˆ°æŒ‡å®šTab
(function() {
  const hash = window.location.hash.replace('#','');
  if(hash && document.getElementById(hash)) {
    switchTab(hash);
  }
})();

// Tabåˆ‡æ¢
function switchTab(tabId) {
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');
  const btnId = 'tabBtn-' + tabId.replace('tab-','');
  const btn = document.getElementById(btnId);
  if(btn) btn.classList.add('active');
}

// æ•°æ®é‡‡é›†æ¨¡æ‹Ÿ
let isCollecting = false;
let curBoxes = 0, curCases = 0, rejectCnt = 0;
let simInterval2 = null;

function toggleCollect() {
  const btn = document.getElementById('collectBtn');
  if(!isCollecting) {
    const productSel = document.getElementById('productSelect');
    const orderNum = document.getElementById('orderNum').value.trim();
    if(!productSel.value) {
      alert('è¯·å…ˆé€‰æ‹©ç”Ÿäº§äº§å“åå†å¼€å§‹é‡‡é›†ï¼');
      productSel.focus();
      return;
    }
    if(!orderNum) {
      alert('è¯·å…ˆå¡«å†™ç”Ÿäº§å•å·åå†å¼€å§‹é‡‡é›†ï¼');
      document.getElementById('orderNum').focus();
      return;
    }
    isCollecting = true;
    btn.textContent = 'åœæ­¢é‡‡é›†';
    btn.style.background = '#DC2626';
    document.getElementById('receivingDot').style.display = 'inline-flex';
    startSimulation2();
    const productName = productSel.options[productSel.selectedIndex].text;
    appendOpLog(`å¼€å§‹é‡‡é›† - äº§å“ï¼š${productName}ï¼Œç”Ÿäº§å•ï¼š${orderNum}`);
  } else {
    isCollecting = false;
    btn.textContent = 'å¼€å§‹é‡‡é›†';
    btn.style.background = '';
    document.getElementById('receivingDot').style.display = 'none';
    if(simInterval2) { clearInterval(simInterval2); simInterval2 = null; }
    appendOpLog('åœæ­¢é‡‡é›†');
  }
}

function startSimulation2() {
  let cycle = 0;

  simInterval2 = setInterval(() => {
    if(!isCollecting) return;
    cycle++;
    const maxBox = parseInt(document.getElementById('boxPerCase').value) || 4;
    const maxCase = parseInt(document.getElementById('casePerPallet').value) || 70;
    const now = new Date();
    const ts = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;

    // æ¯æ¬¡æ¨¡æ‹Ÿé‡‡é›† maxBox ç›’ï¼ˆä¸€æ‰¹ï¼‰ï¼Œç„¶åç®±æ•°+1
    let boxLogs = '';
    for(let i = 0; i < maxBox; i++) {
      const boxSeq = String(1000000 + cycle * maxBox + i).slice(1);
      const boxCode = `20241201${boxSeq}`;
      curBoxes++;
      boxLogs += `<div class="log-entry le-data"><span class="ts">${ts}</span>ç›’ç®±å…³è” - ç›’ç ï¼š${boxCode} â†’ ç®±è¿›åº¦ ${curBoxes}/${maxBox}</div>`;
    }

    // æ•´ç®±å®Œæˆ
    curBoxes = 0;
    curCases++;
    document.getElementById('curBoxes').textContent = curBoxes;
    document.getElementById('curCases').textContent = curCases;

    const caseCode = `20241201C${String(1000 + curCases).slice(1)}`;
    const caseLog = `<div class="log-entry le-data"><span class="ts">${ts}</span>è£…ç®±å®Œæˆ - ç®±ç ï¼š${caseCode} å·²å…³è”${maxBox}ç›’ï¼Œç®±æ•° ${curCases}/${maxCase}</div>`;
    prependLog2('dataArea', caseLog + boxLogs);
    appendOpLog(`ç®±ç å…³è”å®Œæˆï¼š${caseCode}ï¼ˆ${curCases}/${maxCase}ç®±ï¼‰`);

    if(curCases >= maxCase) {
      curCases = 0;
      document.getElementById('curCases').textContent = 0;
      const palletCode = `P20241201${String(100 + cycle).padStart(3,'0')}`;
      prependLog2('dataArea', `<div class="log-entry le-success"><span class="ts">${ts}</span>âš¡ æ»¡å›æç¤º - å›ç ï¼š${palletCode} å·²ç”Ÿæˆï¼Œå…±${maxCase}ç®±ï¼Œæ­£åœ¨ä¸Šä¼ ...</div>`);
      appendOpLog(`æ»¡å› - å›ç ${palletCode}ï¼Œä¸Šä¼ ä¸­`);

      setTimeout(() => {
        const ts2 = getTs();
        prependLog2('dataArea', `<div class="log-entry le-success"><span class="ts">${ts2}</span>âœ“ å›ç ï¼š${palletCode} ä¸Šä¼ æˆåŠŸ</div>`);
        addUploadLog(palletCode);
      }, 3000);
    }

    if(cycle % 8 === 0) {
      const errCode = `20241201${String(999999 - cycle).padStart(6,'0')}`;
      prependLog2('alarmArea', `<div class="log-entry le-error"><span class="ts">${ts}</span>é‡ç : ${errCode} - å·²åœ¨ç åŒ…ä¸­å‡ºç°è¿‡</div>`);
      rejectCnt++;
      document.getElementById('rejectCount').textContent = rejectCnt;
    }

    document.getElementById('syncStatus').innerHTML = '<span>â—</span> å·²åŒæ­¥';
    document.getElementById('syncStatus').className = 'sync-indicator sync-ok';
  }, 3000);
}

function getTs() {
  const now = new Date();
  return `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;
}

function prependLog2(areaId, html) {
  const area = document.getElementById(areaId);
  area.insertAdjacentHTML('afterbegin', html);

  // ä¸ºæœ€æ–°æ’å…¥çš„æ¯æ¡æ–°è®°å½•åŠ å…¥è¿›å…¥åŠ¨ç”»
  const newEntries = [];
  let node = area.firstChild;
  while(node) {
    if(node.nodeType === 1 && node.classList.contains('log-entry') && !node.dataset.animated) {
      newEntries.push(node);
    }
    node = node.nextSibling;
  }
  newEntries.forEach((el, i) => {
    el.dataset.animated = '1';
    const delay = i * 60; // å¤šæ¡æ—¶é”™å¼€å‡ºç°
    if(el.classList.contains('le-success')) {
      el.style.animationDelay = delay + 'ms';
      el.classList.add('log-entry-success');
    } else if(el.classList.contains('le-error')) {
      el.style.animationDelay = delay + 'ms';
      el.classList.add('log-entry-error');
    } else {
      el.style.animationDelay = delay + 'ms';
      el.classList.add('log-entry-new');
    }
  });

  // æ ‡é¢˜æ çŸ­æš‚é«˜äº®
  const header = area.closest('.log-section')?.querySelector('.log-section-header');
  if(header) {
    header.classList.remove('flash-header');
    void header.offsetWidth; // å¼ºåˆ¶é‡ç»˜
    header.classList.add('flash-header');
    header.addEventListener('animationend', () => header.classList.remove('flash-header'), {once:true});
  }

  // è¶…å‡º200æ¡æ¸…é™¤æ—§æ¡ç›®
  const entries = area.querySelectorAll('.log-entry');
  if(entries.length > 200) entries[entries.length-1].remove();
}

function appendOpLog(msg) {
  prependLog2('opLogArea', `<div class="log-entry le-info"><span class="ts">${getTs()}</span>${msg}</div>`);
}

function addUploadLog(palletCode) {
  const area = document.getElementById('uploadLogArea');
  const ts = getTs();
  area.insertAdjacentHTML('afterbegin', `<div class="ul-entry ul-green"><span class="ts">${ts}</span>å›ç  ${palletCode} ä¸Šä¼ æˆåŠŸ</div>`);
  area.insertAdjacentHTML('afterbegin', `<div class="ul-entry ul-blue"><span class="ts">${ts}</span>å›ç  ${palletCode} ä¸Šä¼ ä¸­...</div>`);
}

function closeAlarmDC() {
  alert('æŠ¥è­¦å·²å…³é—­ï¼Œå£°å…‰æŠ¥è­¦å™¨å·²åœæ­¢');
}

function forcePallet() {
  if(confirm('ç¡®è®¤å¼ºåˆ¶æ»¡å›ï¼Ÿå°†å¿½ç•¥é¢„è®¾è¦æ±‚ï¼Œç”Ÿæˆè™šæ‹Ÿå›æ ‡å¹¶é‡ç½®è®¡æ•°ã€‚')) {
    curCases = 0;
    document.getElementById('curCases').textContent = 0;
    appendOpLog('æ‰§è¡Œå¼ºåˆ¶æ»¡å›æ“ä½œ');
  }
}

function clearPallet() {
  if(confirm('ç¡®è®¤æ¸…ç©ºå›ï¼Ÿå°†æ¸…é™¤å½“å‰å›è®¡æ•°ã€‚')) {
    curCases = 0; curBoxes = 0;
    document.getElementById('curCases').textContent = 0;
    document.getElementById('curBoxes').textContent = 0;
    appendOpLog('æ‰§è¡Œæ¸…ç©ºå›æ“ä½œ');
  }
}

function extractUnfinished() {
  alert('æŸ¥è¯¢æœªæˆå›æ•°æ®...\n\næœªæˆå›è®°å½•ï¼š\n1. ç”Ÿäº§å•20241130001 - è¿›åº¦ 45/70ç®±\n\nè¯·é€‰æ‹©åç»§ç»­ç”Ÿäº§');
}

function resetReject() {
  if(confirm('ç¡®è®¤å°†æ€»å‰”é™¤æ•°æ¸…é›¶ï¼Ÿ')) {
    rejectCnt = 0;
    document.getElementById('rejectCount').textContent = 0;
  }
}

// äº§å“é€‰æ‹©
function updateProductInfo() {
  const sel = document.getElementById('productSelect');
  const codeArea = document.getElementById('productCodeArea');
  const codeDisplay = document.getElementById('productCodeDisplay');
  const codes = {'P001':'SHW-001','P002':'SHW-002','P003':'SHW-003','P004':'SHW-004'};
  if(sel.value) {
    codeArea.style.display = 'block';
    codeDisplay.textContent = codes[sel.value] || 'â€”';
  } else {
    codeArea.style.display = 'none';
  }
}

// æ‰‹å·¥é‡‡é›†
function updateManualUI() {
  const type = document.querySelector('input[name="assocType"]:checked').value;
  const isBottleBox = type === 'bottle-box';
  document.getElementById('currentCountLabel').textContent = isBottleBox ? 'å½“å‰å·²è¯»ç“¶ç æ•°' : 'å½“å‰å·²è¯»ç›’ç æ•°';
  document.getElementById('perCountLabel').textContent = isBottleBox ? 'æ¯ç“¶ç æ•°ï¼ˆæ¯ç›’ï¼‰' : 'æ¯ç›’ç æ•°ï¼ˆæ¯ç®±ï¼‰';
  document.getElementById('scanLight').textContent = isBottleBox ? 'â— ç“¶ç æ‰«æä¸­' : 'â— ç›’ç æ‰«æä¸­';
  document.getElementById('promptCode1').textContent = isBottleBox ? 'ç“¶ç ' : 'ç›’ç ';
  document.getElementById('promptCode2').textContent = isBottleBox ? 'ç›’ç ' : 'ç®±ç ';
  // åˆ‡æ¢æ—¶è‡ªåŠ¨æ›´æ–°é»˜è®¤æ•°é‡ï¼šç“¶ç›’å…³è”é»˜è®¤6ï¼Œç›’ç®±å…³è”é»˜è®¤4
  document.getElementById('manualN').value = isBottleBox ? 6 : 4;
}

// æ•°æ®æŸ¥è¯¢
// â”€â”€ æ¨¡æ‹Ÿæ•°æ®ç»“æ„ï¼šå› P20241201001 â”€â”€
// å› â†’ 3ç®± â†’ æ¯ç®±4ç›’ â†’ æ¯ç›’6ç“¶
const mockData = {
  // ====== å›ç  ======
  'P20241201001': {
    level:'å›ç ', time:'2024-12-01 11:00:00',
    children:['20241201C001','20241201C002','20241201C003']
  },

  // ====== ç®±ç  ======
  '20241201C001': {
    level:'ç®±ç ', time:'2024-12-01 10:58:42', parent:'P20241201001',
    children:['20241201B0101','20241201B0102','20241201B0103','20241201B0104']
  },
  '20241201C002': {
    level:'ç®±ç ', time:'2024-12-01 10:59:10', parent:'P20241201001',
    children:['20241201B0201','20241201B0202','20241201B0203','20241201B0204']
  },
  '20241201C003': {
    level:'ç®±ç ', time:'2024-12-01 10:59:38', parent:'P20241201001',
    children:['20241201B0301','20241201B0302','20241201B0303','20241201B0304']
  },

  // ====== ç›’ç ï¼ˆç®±1ï¼‰======
  '20241201B0101': {
    level:'ç›’ç ', time:'2024-12-01 10:55:01', parent:'20241201C001',
    children:['20241201V010101','20241201V010102','20241201V010103','20241201V010104','20241201V010105','20241201V010106']
  },
  '20241201B0102': {
    level:'ç›’ç ', time:'2024-12-01 10:55:22', parent:'20241201C001',
    children:['20241201V010201','20241201V010202','20241201V010203','20241201V010204','20241201V010205','20241201V010206']
  },
  '20241201B0103': {
    level:'ç›’ç ', time:'2024-12-01 10:55:43', parent:'20241201C001',
    children:['20241201V010301','20241201V010302','20241201V010303','20241201V010304','20241201V010305','20241201V010306']
  },
  '20241201B0104': {
    level:'ç›’ç ', time:'2024-12-01 10:56:04', parent:'20241201C001',
    children:['20241201V010401','20241201V010402','20241201V010403','20241201V010404','20241201V010405','20241201V010406']
  },

  // ====== ç›’ç ï¼ˆç®±2ï¼‰======
  '20241201B0201': {
    level:'ç›’ç ', time:'2024-12-01 10:56:30', parent:'20241201C002',
    children:['20241201V020101','20241201V020102','20241201V020103','20241201V020104','20241201V020105','20241201V020106']
  },
  '20241201B0202': {
    level:'ç›’ç ', time:'2024-12-01 10:56:51', parent:'20241201C002',
    children:['20241201V020201','20241201V020202','20241201V020203','20241201V020204','20241201V020205','20241201V020206']
  },
  '20241201B0203': {
    level:'ç›’ç ', time:'2024-12-01 10:57:12', parent:'20241201C002',
    children:['20241201V020301','20241201V020302','20241201V020303','20241201V020304','20241201V020305','20241201V020306']
  },
  '20241201B0204': {
    level:'ç›’ç ', time:'2024-12-01 10:57:33', parent:'20241201C002',
    children:['20241201V020401','20241201V020402','20241201V020403','20241201V020404','20241201V020405','20241201V020406']
  },

  // ====== ç›’ç ï¼ˆç®±3ï¼‰======
  '20241201B0301': {
    level:'ç›’ç ', time:'2024-12-01 10:57:55', parent:'20241201C003',
    children:['20241201V030101','20241201V030102','20241201V030103','20241201V030104','20241201V030105','20241201V030106']
  },
  '20241201B0302': {
    level:'ç›’ç ', time:'2024-12-01 10:58:10', parent:'20241201C003',
    children:['20241201V030201','20241201V030202','20241201V030203','20241201V030204','20241201V030205','20241201V030206']
  },
  '20241201B0303': {
    level:'ç›’ç ', time:'2024-12-01 10:58:22', parent:'20241201C003',
    children:['20241201V030301','20241201V030302','20241201V030303','20241201V030304','20241201V030305','20241201V030306']
  },
  '20241201B0304': {
    level:'ç›’ç ', time:'2024-12-01 10:58:35', parent:'20241201C003',
    children:['20241201V030401','20241201V030402','20241201V030403','20241201V030404','20241201V030405','20241201V030406']
  },

  // ====== ç“¶ç ï¼ˆç›’B0101çš„6ç“¶ï¼‰======
  '20241201V010101':{ level:'ç“¶ç ', time:'2024-12-01 10:54:01', parent:'20241201B0101' },
  '20241201V010102':{ level:'ç“¶ç ', time:'2024-12-01 10:54:03', parent:'20241201B0101' },
  '20241201V010103':{ level:'ç“¶ç ', time:'2024-12-01 10:54:05', parent:'20241201B0101' },
  '20241201V010104':{ level:'ç“¶ç ', time:'2024-12-01 10:54:07', parent:'20241201B0101' },
  '20241201V010105':{ level:'ç“¶ç ', time:'2024-12-01 10:54:09', parent:'20241201B0101' },
  '20241201V010106':{ level:'ç“¶ç ', time:'2024-12-01 10:54:11', parent:'20241201B0101' },
};
const levelColors = { 'ç“¶ç ':'level-bottle', 'ç›’ç ':'level-box', 'ç®±ç ':'level-case', 'å›ç ':'level-pallet' };

// ä» mockData åŠ¨æ€å‘ä¸Šè¿½æº¯å®Œæ•´å…³è”é“¾è·¯
function buildChain(code) {
  const chain = [];
  let cur = code;
  while(cur && mockData[cur]) {
    chain.unshift({ code: cur, level: mockData[cur].level });
    cur = mockData[cur].parent;
  }
  if(cur && !mockData[cur]) chain.unshift({ code: cur, level: 'å›ç ' }); // å›ç å¯èƒ½æ²¡æœ‰parent
  return chain;
}

// æ‰¾æŸä¸ªç çš„æ‰€æœ‰åŒçº§å…„å¼Ÿï¼ˆçˆ¶èŠ‚ç‚¹çš„ childrenï¼‰
function getSiblings(code) {
  const d = mockData[code];
  if(!d || !d.parent) return [code];
  const parent = mockData[d.parent];
  if(parent && parent.children) return parent.children;
  return [code];
}

const levelColorMap = { 'ç“¶ç ':'#1D4ED8', 'ç›’ç ':'#15803D', 'ç®±ç ':'#C2410C', 'å›ç ':'#7C3AED' };

function renderCodeInfo(code) {
  const d = mockData[code];
  document.getElementById('qCodeVal').textContent = code;
  if(d) {
    document.getElementById('qCodeLevel').textContent = d.level;
    document.getElementById('qCodeLevel').className = 'chain-tag ' + levelColors[d.level];
    document.getElementById('qCodeTime').textContent = d.time;
  } else {
    document.getElementById('qCodeLevel').textContent = 'æœªçŸ¥';
    document.getElementById('qCodeLevel').className = 'chain-tag';
    document.getElementById('qCodeTime').textContent = 'â€”';
  }
}

function doForwardQuery() {
  const code = document.getElementById('queryInput').value.trim();
  if(!code) return;
  document.getElementById('queryEmpty').style.display = 'none';
  document.getElementById('queryResult').style.display = 'block';
  document.getElementById('forwardResult').style.display = 'none';
  document.getElementById('reverseResult').style.display = 'none';

  const d = mockData[code];
  const status = document.getElementById('queryStatus');
  renderCodeInfo(code);

  if(d) {
    status.innerHTML = '<span style="color:#16A34A; font-weight:600;">âœ“ æ­£å‘æŸ¥è¯¢æˆåŠŸ</span>';
    const levelMap = { 'å›ç ':'ç®±ç ', 'ç®±ç ':'ç›’ç ', 'ç›’ç ':'ç“¶ç ' };
    const childLevel = levelMap[d.level] || 'ä¸‹çº§';
    document.getElementById('forwardResultTitle').textContent = `æ­£å‘æŸ¥è¯¢ç»“æœï¼ˆç›´æ¥ä¸‹çº§ - ${childLevel}ï¼‰ï¼š`;

    if(d.children && d.children.length > 0) {
      const color = levelColorMap[childLevel] || '#374151';
      let rows = d.children.map((c, i) => {
        const ct = mockData[c] ? mockData[c].time : 'â€”';
        return `<tr ${i%2?'class="row-even"':''}><td>${i+1}</td><td style="color:${color}; font-weight:600;">${c}</td><td style="color:#6B7280;">${ct}</td></tr>`;
      }).join('');
      document.getElementById('forwardTableWrap').innerHTML =
        `<div style="font-size:14px;color:#374151;margin-bottom:8px;">${childLevel}åˆ—è¡¨ï¼ˆå…± <b>${d.children.length}</b> ä¸ªï¼‰</div>
         <table class="data-table"><thead><tr><th style="width:50px;">åºå·</th><th>${childLevel}</th><th>é‡‡é›†æ—¶é—´</th></tr></thead><tbody>${rows}</tbody></table>`;
    } else {
      document.getElementById('forwardTableWrap').innerHTML =
        `<div style="color:#9CA3AF;padding:24px;text-align:center;">è¯¥ <b>${d.level}</b> å·²æ˜¯æœ€åº•å±‚ï¼Œæš‚æ— ä¸‹çº§å…³è”ç </div>`;
    }
    document.getElementById('forwardResult').style.display = 'block';
  } else {
    status.innerHTML = '<span style="color:#DC2626;font-weight:600;">âœ— æœªæ‰¾åˆ°è¯¥ç ï¼Œè¯·æ£€æŸ¥ç å€¼æ˜¯å¦æ­£ç¡®</span>';
    document.getElementById('forwardTableWrap').innerHTML =
      '<div style="color:#9CA3AF;padding:24px;text-align:center;">æœªæ‰¾åˆ°è¯¥ç ä¿¡æ¯</div>';
    document.getElementById('forwardResult').style.display = 'block';
  }
}

function doReverseQuery() {
  const code = document.getElementById('queryInput').value.trim();
  if(!code) return;
  document.getElementById('queryEmpty').style.display = 'none';
  document.getElementById('queryResult').style.display = 'block';
  document.getElementById('forwardResult').style.display = 'none';
  document.getElementById('reverseResult').style.display = 'none';

  const d = mockData[code];
  const status = document.getElementById('queryStatus');
  renderCodeInfo(code);

  if(d && d.level !== 'å›ç ') {
    status.innerHTML = '<span style="color:#16A34A;font-weight:600;">âœ“ åå‘æŸ¥è¯¢æˆåŠŸ</span>';

    // åŠ¨æ€æ„å»ºå®Œæ•´å…³è”é“¾è·¯ï¼ˆä»å›åˆ°å½“å‰ç ï¼Œæ’é™¤å½“å‰ç æœ¬èº«ï¼‰
    const chain = buildChain(code).filter(n => n.code !== code);
    let chainHtml = chain.map(n =>
      `<span class="chain-tag ${levelColors[n.level]}">${n.level}</span>
       <span style="color:${levelColorMap[n.level]};font-weight:600;">${n.code}</span>
       <span class="chain-arrow">â†’</span>`
    ).join('');
    chainHtml += `<span class="chain-tag ${levelColors[d.level]}">${d.level}</span>
                  <span style="color:${levelColorMap[d.level]};font-weight:700;">${code} <span style="font-size:12px;color:#DC2626;">ï¼ˆå½“å‰ï¼‰</span></span>`;
    document.getElementById('chainPath').innerHTML = chainHtml;

    // åŒçº§åˆ—è¡¨
    const siblings = getSiblings(code);
    const levelMap = { 'ç®±ç ':'å›ç ', 'ç›’ç ':'ç®±ç ', 'ç“¶ç ':'ç›’ç ' };
    const parentLevel = levelMap[d.level] || '';
    document.getElementById('sameLevel').textContent = `åŒçº§æ•°æ®ï¼ˆ${parentLevel}å†…å…± ${siblings.length} ä¸ª${d.level}ï¼‰ï¼š`;
    let rows = siblings.map((c, i) => {
      const isCur = c === code;
      const ct = mockData[c] ? mockData[c].time : 'â€”';
      return `<tr ${i%2?'class="row-even"':''} ${isCur?'style="background:#FEF2F2;"':''}>
        <td>${i+1}</td>
        <td style="color:${isCur?'#DC2626':levelColorMap[d.level]};font-weight:${isCur?700:500};">
          ${c}${isCur?' <span style="font-size:11px;color:#DC2626;font-weight:600;">â† å½“å‰æŸ¥è¯¢</span>':''}
        </td>
        <td style="color:#6B7280;">${ct}</td>
      </tr>`;
    }).join('');
    document.getElementById('reverseTableWrap').innerHTML =
      `<table class="data-table"><thead><tr><th style="width:50px;">åºå·</th><th>${d.level}</th><th>é‡‡é›†æ—¶é—´</th></tr></thead><tbody>${rows}</tbody></table>
       <div style="font-size:12px;color:#9CA3AF;margin-top:6px;">å½“å‰æŸ¥è¯¢ç ä»¥çº¢è‰²é«˜äº®æ˜¾ç¤º</div>`;
    document.getElementById('reverseResult').style.display = 'block';
  } else if(d && d.level === 'å›ç ') {
    status.innerHTML = '<span style="color:#F59E0B;font-weight:600;">âš  å›ç ä¸ºæœ€é¡¶å±‚ï¼Œæ— ä¸Šçº§å…³è”</span>';
    document.getElementById('chainPath').innerHTML = `<span class="chain-tag level-pallet">å›ç </span><span style="color:#7C3AED;font-weight:700;">${code} <span style="font-size:12px;color:#DC2626;">ï¼ˆé¡¶å±‚ï¼‰</span></span>`;
    document.getElementById('reverseTableWrap').innerHTML = '<div style="color:#9CA3AF;padding:24px;text-align:center;">å›ç ä¸ºæœ€é¡¶å±‚ï¼Œæ— ä¸Šçº§å…³è”ç </div>';
    document.getElementById('reverseResult').style.display = 'block';
  } else {
    status.innerHTML = '<span style="color:#DC2626;font-weight:600;">âœ— æœªæ‰¾åˆ°è¯¥ç ï¼Œè¯·æ£€æŸ¥ç å€¼æ˜¯å¦æ­£ç¡®</span>';
    document.getElementById('chainPath').innerHTML = '<span style="color:#9CA3AF;">æœªæ‰¾åˆ°è¯¥ç ä¿¡æ¯</span>';
    document.getElementById('reverseTableWrap').innerHTML = '';
    document.getElementById('reverseResult').style.display = 'block';
  }
}

function clearQuery() {
  document.getElementById('queryInput').value = '';
  document.getElementById('queryStatus').innerHTML = '<span style="color:#9CA3AF;">è¯·è¾“å…¥ç è¿›è¡ŒæŸ¥è¯¢</span>';
  document.getElementById('queryResult').style.display = 'none';
  document.getElementById('queryEmpty').style.display = 'flex';
}

function showQueryHelp() {
  showHelp('æŸ¥è¯¢è¯´æ˜',
    'ã€æ­£å‘æŸ¥è¯¢ã€‘æŸ¥è¯¢ä¸‹çº§ç \n  â€¢ æŸ¥è¯¢è¯¥ç çš„ç›´æ¥ä¸‹çº§ç \n  â€¢ åªæ˜¾ç¤ºä¸€å±‚ä¸‹çº§ï¼Œé¿å…æ•°æ®é‡è¿‡å¤§\n\nã€åå‘æŸ¥è¯¢ã€‘æŸ¥è¯¢ä¸Šçº§ç \n  â€¢ æŸ¥è¯¢è¯¥ç çš„æ‰€æœ‰ä¸Šçº§ç \n  â€¢ åŒæ—¶æ˜¾ç¤ºåŒçº§å…¶ä»–ç \n\nå››çº§åŒ…è£…ç»“æ„ï¼šç“¶ â†’ ç›’ â†’ ç®± â†’ å›\n\nå¿«æ·é”®ï¼šEnter=æ­£å‘æŸ¥è¯¢ï¼ŒCtrl+Enter=åå‘æŸ¥è¯¢'
  );
}

document.addEventListener('keydown', e => {
  if(e.key==='Enter' && e.ctrlKey && document.getElementById('tab-query').classList.contains('active')) doReverseQuery();
});

// æ•°æ®æ›¿æ¢
function clearReplace() {
  document.getElementById('origCode').value = '';
  document.getElementById('newCode').value = '';
  document.getElementById('replaceReason').value = '';
}

function openReplaceConfirm() {
  const orig = document.getElementById('origCode').value.trim();
  const newC = document.getElementById('newCode').value.trim();
  if(!orig || !newC) { alert('è¯·å¡«å†™åŸç å’Œæ–°ç '); return; }
  document.getElementById('confirmTitle').textContent = 'ç¡®è®¤ç æ›¿æ¢';
  document.getElementById('confirmMsg').innerHTML = `<strong>åŸç å€¼ï¼š</strong>${orig}<br><strong>æ–°ç å€¼ï¼š</strong>${newC}<br><strong>æ›¿æ¢åŸå› ï¼š</strong>${document.getElementById('replaceReason').value || 'ï¼ˆæœªå¡«å†™ï¼‰'}`;
  document.getElementById('confirmPwd').value = '';
  document.getElementById('confirmPwdErr').textContent = '';
  currentConfirmAction = () => {
    const ts = new Date().toLocaleString('zh-CN');
    const area = document.getElementById('replaceResultArea');
    area.innerHTML = `<div style="border:1px solid #D1FAE5; border-radius:8px; padding:14px; margin-bottom:10px; background:#F0FDF4;">
      <div style="color:#16A34A; font-size:16px; font-weight:700; margin-bottom:8px;">âœ“ ç æ›¿æ¢æˆåŠŸï¼</div>
      <div style="font-size:14px; color:#374151; line-height:1.8;">åŸç ï¼š${orig}<br>æ–°ç ï¼š${newC}<br>æ›¿æ¢åŸå› ï¼š${document.getElementById('replaceReason').value || 'â€”'}<br>æ“ä½œæ—¶é—´ï¼š${ts}</div>
    </div>` + area.innerHTML;
    clearReplace();
  };
  document.getElementById('confirmOverlay').classList.add('active');
}

// â”€â”€ å–æ¶ˆå…³è”æ¨¡å— â”€â”€
let cancelMode = 'single';
// ç”¨äºè®°å½•å½“å‰è¯†åˆ«ç»“æœï¼ˆä¾›ç¡®è®¤æ—¶ä½¿ç”¨ï¼‰
let cancelRecognizeInfo = null;

function switchCancelMode(mode) {
  cancelMode = mode;
  document.getElementById('cancelSingle').classList.toggle('active', mode === 'single');
  document.getElementById('cancelBatch').classList.toggle('active', mode === 'batch');
  document.getElementById('cancelSingleContent').classList.toggle('active', mode === 'single');
  document.getElementById('cancelBatchContent').classList.toggle('active', mode === 'batch');
  // åˆ‡æ¢æ—¶æ¸…ç©ºè¯†åˆ«ç»“æœæç¤º
  resetRecognizeResult(mode === 'single' ? 'è¯·åœ¨å·¦ä¾§è¾“å…¥ç å€¼å¹¶ç‚¹å‡»è¯†åˆ«' : 'è¯·åœ¨å·¦ä¾§æ·»åŠ å¤§ç å¹¶ç‚¹å‡»è¯†åˆ«');
}

function resetRecognizeResult(msg) {
  document.getElementById('recognizeResult').innerHTML =
    `<div style="color:#9CA3AF;font-size:15px;text-align:center;padding-top:60px;">${msg}</div>`;
  document.getElementById('recognizeHint').textContent = 'è¯†åˆ«åå°†åœ¨æ­¤æ˜¾ç¤º';
  cancelRecognizeInfo = null;
}

// æ ¹æ® mockData åˆ†æä¸€ä¸ªç çš„å¯è§£é™¤çŠ¶æ€
function analyzeCancelCode(code) {
  const d = mockData[code];
  if(!d) return null;
  const hasParent = !!d.parent;
  const childCount = d.children ? d.children.length : 0;
  // æ„å»ºå®Œæ•´é“¾è·¯ï¼ˆä¸å«å½“å‰ç æœ¬èº«ï¼‰
  const chain = buildChain(code).filter(n => n.code !== code);
  return { code, level: d.level, hasParent, childCount, chain };
}

function renderCancelItem(info) {
  if(!info) return '';
  const levelColor = { 'å›ç ':'#7C3AED','ç®±ç ':'#C2410C','ç›’ç ':'#15803D','ç“¶ç ':'#1D4ED8' };
  const col = levelColor[info.level] || '#374151';
  if(!info.hasParent) {
    const childDesc = info.childCount > 0 ? `ï¼Œè§£é™¤ <b>${info.childCount}</b> ä¸ª` : 'ï¼ˆå·²æ˜¯åº•å±‚ï¼Œæ— ä¸‹çº§ï¼‰';
    return `<div class="cr-item cr-ok">
      <span class="cr-badge cr-badge-ok">å¯è§£é™¤å…³è”</span>
      <span style="color:${col};font-weight:700;">${info.level} ${info.code}</span>${childDesc}
    </div>`;
  } else {
    const levelMap = { 'å›ç ':'å›','ç®±ç ':'ç®±','ç›’ç ':'ç›’','ç“¶ç ':'ç“¶' };
    const parentLabel = info.chain.length > 0 ? info.chain[info.chain.length-1].level : 'ä¸Šçº§';
    const chainStr = info.chain.map(n => `${n.level} ${n.code}`).join(' â†’ ');
    return `<div class="cr-item cr-err">
      <span class="cr-badge cr-badge-err">ä¸å¯è§£é™¤å…³è”</span>
      <span style="color:${col};font-weight:700;">${info.level} ${info.code}</span>
      <span style="color:#DC2626;">ï¼ˆ${levelMap[info.level]}å·²å…³è”è‡³${parentLabel}ï¼Œè¯·å…ˆè§£é™¤ä¸Šçº§ï¼‰</span>
      <div class="cr-chain">é“¾è·¯: ${chainStr} â†’ <b>${info.code}</b></div>
    </div>`;
  }
}

// å•ä¸ªè¯†åˆ«
function doRecognize() {
  const c1 = document.getElementById('code1').value.trim();
  const c2 = document.getElementById('code2').value.trim();
  if(!c1 || !c2) { alert('è¯·è¾“å…¥ä¸¤ä¸ªç åå†ç‚¹å‡»è¯†åˆ«'); return; }

  const info1 = analyzeCancelCode(c1);
  const info2 = analyzeCancelCode(c2);

  let html = '';
  let canCancel = false;

  if(!info1 && !info2) {
    html = `<div style="color:#DC2626;font-size:14px;padding:16px;">âœ— ä¸¤ä¸ªç å‡æœªåœ¨ç³»ç»Ÿä¸­æ‰¾åˆ°ï¼Œè¯·æ£€æŸ¥ç å€¼</div>`;
  } else {
    // æ‰¾åˆ°çš„ç æ˜¾ç¤ºè¯†åˆ«ç»“æœ
    [info1, info2].filter(Boolean).forEach(info => { html += renderCancelItem(info); });
    // åªè¦æœ‰ä¸€ä¸ªç æ— ä¸Šçº§å…³è”ï¼Œå°±å…è®¸è§£é™¤ï¼ˆè¯¥ç å¯¹åº”çš„å…³ç³»ï¼‰
    const cancelableInfos = [info1, info2].filter(i => i && !i.hasParent);
    canCancel = cancelableInfos.length > 0;
    cancelRecognizeInfo = { type: 'single', items: [info1, info2].filter(Boolean) };
  }

  document.getElementById('recognizeResult').innerHTML = html;
  document.getElementById('recognizeHint').textContent =
    canCancel ? 'âœ“ è¯†åˆ«å®Œæˆï¼Œå¯æ‰§è¡Œè§£é™¤' : 'âš  è¯†åˆ«å®Œæˆï¼Œæœ‰ä¸Šçº§å…³è”';

  const btn = document.getElementById('confirmCancelBtn');
  const hint = document.getElementById('cancelBtnHint');
  btn.disabled = !canCancel;
  hint.style.display = canCancel ? 'none' : 'block';
}

function clearCancel() {
  document.getElementById('code1').value = '';
  document.getElementById('code2').value = '';
  document.getElementById('confirmCancelBtn').disabled = true;
  document.getElementById('cancelBtnHint').style.display = 'none';
  resetRecognizeResult('è¯·åœ¨å·¦ä¾§è¾“å…¥ç å€¼å¹¶ç‚¹å‡»è¯†åˆ«');
}

// æ‰¹é‡ç åˆ—è¡¨
const batchCodes = [];
function addBatchCode() {
  const code = document.getElementById('batchCode').value.trim();
  if(!code) return;
  if(batchCodes.includes(code)) { alert('è¯¥ç å·²åœ¨åˆ—è¡¨ä¸­'); return; }
  batchCodes.push(code);
  document.getElementById('batchCode').value = '';
  document.getElementById('batchCode').focus();
  renderBatchList();
}

function renderBatchList() {
  const list = document.getElementById('batchCodeList');
  if(batchCodes.length === 0) {
    list.innerHTML = '<div style="color:#9CA3AF;font-size:14px;text-align:center;padding:20px;">æš‚æ— æ·»åŠ çš„å¤§ç </div>';
    return;
  }
  list.innerHTML = batchCodes.map((c, i) => {
    const d = mockData[c];
    const levelLabel = d ? d.level : 'æœªçŸ¥';
    return `<div class="batch-list-item">
      <span style="color:#374151;">${i+1}. <span style="color:#2563EB;font-weight:600;">${levelLabel}</span> ${c}</span>
      <button class="batch-del-btn" onclick="removeBatchCode(${i})">åˆ é™¤</button>
    </div>`;
  }).join('');
}

function removeBatchCode(idx) { batchCodes.splice(idx, 1); renderBatchList(); }

function clearBatch() {
  batchCodes.length = 0;
  renderBatchList();
  resetRecognizeResult('è¯·åœ¨å·¦ä¾§æ·»åŠ å¤§ç å¹¶ç‚¹å‡»è¯†åˆ«');
  cancelRecognizeInfo = null;
}

// æ‰¹é‡è¯†åˆ«
function doBatchRecognize() {
  if(batchCodes.length === 0) { alert('è¯·å…ˆæ·»åŠ å¤§ç '); return; }
  const infos = batchCodes.map(c => analyzeCancelCode(c) || { code: c, level:'æœªçŸ¥', hasParent:true, childCount:0, chain:[], notFound:true });
  let html = '';
  let cancelableCount = 0, cancelableRelations = 0;

  infos.forEach((info, i) => {
    if(info.notFound) {
      html += `<div class="cr-item cr-err"><span class="cr-badge cr-badge-err">æœªæ‰¾åˆ°</span><span style="font-weight:700;">${info.code}</span> â€” è¯¥ç ä¸å­˜åœ¨</div>`;
    } else {
      html += renderCancelItem(info);
      if(!info.hasParent && info.childCount > 0) {
        cancelableCount++;
        cancelableRelations += info.childCount;
      }
    }
  });

  if(cancelableCount > 0) {
    html += `<div class="cr-summary">ğŸ“Š æ€»å½±å“èŒƒå›´ï¼š<b>${cancelableCount}</b> ä¸ªåŒ…è£…å•å…ƒå¯è§£é™¤ï¼Œæ¶‰åŠ <b>${cancelableRelations}</b> ä¸ªç å…³ç³»</div>`;
  } else {
    html += `<div class="cr-summary" style="background:#FEF2F2;border-color:#FCA5A5;color:#991B1B;">âš  æ‰€æœ‰å•å…ƒå‡æœ‰ä¸Šçº§å…³è”ï¼Œè¯·å…ˆä»å›å¼€å§‹é€çº§è§£é™¤</div>`;
  }

  document.getElementById('recognizeResult').innerHTML = html;
  document.getElementById('recognizeHint').textContent = cancelableCount > 0
    ? `âœ“ è¯†åˆ«å®Œæˆï¼Œ${cancelableCount}ä¸ªå•å…ƒå¯è§£é™¤` : 'âš  å…¨éƒ¨æœ‰ä¸Šçº§å…³è”';
  cancelRecognizeInfo = { type: 'batch', items: infos, cancelableCount, cancelableRelations };
}

// ç»Ÿä¸€ç¡®è®¤å…¥å£
function openCancelConfirm(mode) {
  if(mode === 'batch') {
    if(batchCodes.length === 0) { alert('è¯·å…ˆæ·»åŠ å¤§ç '); return; }
    if(!cancelRecognizeInfo) { alert('è¯·å…ˆç‚¹å‡»è¯†åˆ«'); return; }
    const { cancelableCount, cancelableRelations } = cancelRecognizeInfo;
    document.getElementById('confirmTitle').textContent = 'æ‰¹é‡å–æ¶ˆå…³è”ç¡®è®¤';
    document.getElementById('confirmMsg').innerHTML =
      `å°†æ‰¹é‡å–æ¶ˆå…³è” <b>${cancelableCount}</b> ä¸ªåŒ…è£…å•å…ƒï¼Œæ¶‰åŠ <b>${cancelableRelations}</b> ä¸ªç å…³ç³»<br>
       <span style="color:#DC2626;font-size:13px;">æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·ä»”ç»†æ ¸å¯¹åç¡®è®¤ï¼</span>`;
    currentConfirmAction = () => execCancelConfirm('batch');
  } else {
    if(!cancelRecognizeInfo) { alert('è¯·å…ˆç‚¹å‡»è¯†åˆ«'); return; }
    const cancelableItems = cancelRecognizeInfo.items.filter(i => !i.hasParent);
    document.getElementById('confirmTitle').textContent = 'å–æ¶ˆå…³è”ç¡®è®¤';
    const desc = cancelableItems.map(i => `${i.level} ${i.code}ï¼ˆè§£é™¤${i.childCount}ä¸ªï¼‰`).join('ã€');
    document.getElementById('confirmMsg').innerHTML =
      `ç¡®è®¤å–æ¶ˆå…³è”ï¼š<b>${desc || 'å·²è¯†åˆ«ç '}</b><br>
       <span style="color:#DC2626;font-size:13px;">æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·ä»”ç»†æ ¸å¯¹åç¡®è®¤ï¼</span>`;
    currentConfirmAction = () => execCancelConfirm('single');
  }
  document.getElementById('confirmPwd').value = '';
  document.getElementById('confirmPwdErr').textContent = '';
  document.getElementById('confirmOverlay').classList.add('active');
}

function execCancelConfirm(mode) {
  const ts = getTs();
  const log = document.getElementById('cancelResultLog');
  // æ¸…é™¤ç©ºçŠ¶æ€
  const empty = log.querySelector('div[style*="æš‚æ— "]');
  if(empty) log.innerHTML = '';

  if(mode === 'single') {
    const cancelableItems = (cancelRecognizeInfo?.items || []).filter(i => !i.hasParent);
    // æ¨¡æ‹Ÿäº‘ç«¯æ£€æŸ¥ï¼ˆéšæœºå·²ä¸Šä¼ ï¼‰
    const uploaded = Math.random() > 0.4;
    let logHtml = '';
    cancelableItems.forEach(info => {
      if(uploaded) {
        logHtml += `<div class="cl-entry"><span class="cl-ts">${ts}</span>ğŸŒ äº‘ç«¯æ£€æŸ¥ï¼š${info.level} ${info.code} å·²ä¸Šä¼ ï¼Œæ­£åœ¨äº‘ç«¯è§£é™¤...</div>`;
      }
      logHtml += `<div class="cl-entry cl-ok"><span class="cl-ts">${ts}</span>âœ“ ${info.level} ${info.code} å–æ¶ˆå…³è”æˆåŠŸï¼Œè§£é™¤ ${info.childCount} ä¸ªå…³è”å…³ç³»${uploaded ? 'ï¼ˆå«äº‘ç«¯ï¼‰' : ''}</div>`;
    });
    log.insertAdjacentHTML('afterbegin', logHtml);
    clearCancel();
  } else {
    const { items, cancelableCount, cancelableRelations } = cancelRecognizeInfo || {};
    const cancelableItems = (items || []).filter(i => !i.hasParent);
    const uploaded = Math.random() > 0.4;
    let logHtml = '';
    if(uploaded) {
      logHtml += `<div class="cl-entry"><span class="cl-ts">${ts}</span>ğŸŒ äº‘ç«¯æ£€æŸ¥ï¼š${cancelableCount}ä¸ªå•å…ƒå·²ä¸Šä¼ ï¼Œæ­£åœ¨æ‰¹é‡äº‘ç«¯è§£é™¤...</div>`;
    }
    cancelableItems.forEach(info => {
      logHtml += `<div class="cl-entry cl-ok"><span class="cl-ts">${ts}</span>âœ“ ${info.level} ${info.code} å–æ¶ˆå…³è”æˆåŠŸï¼Œè§£é™¤ ${info.childCount} ä¸ªå…³è”å…³ç³»</div>`;
    });
    logHtml += `<div class="cl-entry cl-ok" style="font-weight:700;"><span class="cl-ts">${ts}</span>âœ“ æ‰¹é‡æ“ä½œå®Œæˆï¼š${cancelableCount}ä¸ªå•å…ƒï¼Œå…±è§£é™¤ ${cancelableRelations} ä¸ªç å…³ç³»${uploaded?'ï¼ˆäº‘ç«¯+æœ¬åœ°ï¼‰':'ï¼ˆæœ¬åœ°ï¼‰'}</div>`;
    log.insertAdjacentHTML('afterbegin', logHtml);
    clearBatch();
  }
}

// ç”Ÿäº§ç»Ÿè®¡
function doStatsQuery() {
  document.getElementById('statPallet').textContent = Math.floor(Math.random()*50+80);
  document.getElementById('statCase').textContent = (parseInt(document.getElementById('statPallet').textContent)*70).toLocaleString();
  document.getElementById('statBox').textContent = (parseInt(document.getElementById('statCase').textContent)*4).toLocaleString();
}

function openPalletList() { document.getElementById('palletListOverlay').classList.add('active'); }
function closePalletList() { document.getElementById('palletListOverlay').classList.remove('active'); }

// æ•°æ®ä¸Šä¼ 
function doManualUpload() {
  const ts = getTs();
  const area = document.getElementById('uploadLogArea');
  area.insertAdjacentHTML('afterbegin', `<div class="ul-entry ul-gray"><span class="ts">${ts}</span>æ‰‹åŠ¨ä¸Šä¼ ï¼šæ­£åœ¨æŸ¥æ‰¾æ‰€æœ‰æœªä¸Šä¼ çš„å›æ•°æ®...</div>`);
  setTimeout(() => {
    const ts2 = getTs();
    area.insertAdjacentHTML('afterbegin', `<div class="ul-entry ul-blue"><span class="ts">${ts2}</span>å›ç  P20241201-NEW ä¸Šä¼ ä¸­...</div>`);
    setTimeout(() => {
      const ts3 = getTs();
      area.insertAdjacentHTML('afterbegin', `<div class="ul-entry ul-green"><span class="ts">${ts3}</span>å›ç  P20241201-NEW ä¸Šä¼ æˆåŠŸ</div>`);
      area.insertAdjacentHTML('afterbegin', `<div class="ul-entry ul-green"><span class="ts">${ts3}</span>æ‰‹åŠ¨ä¸Šä¼ å®Œæˆï¼ŒæˆåŠŸ1ä¸ªï¼Œå¤±è´¥0ä¸ª</div>`);
    }, 2000);
  }, 1000);
}

function queryUploadStatus() {
  const code = document.getElementById('uploadQueryCode').value.trim();
  if(!code) { alert('è¯·è¾“å…¥å›ç '); return; }
  const isKnown = ['D001-2410101','D002-2410101','D003-2410101','D004-2410101','D005-2410101'].includes(code);
  const statuses = ['æˆåŠŸ','å¤±è´¥','æœªä¸Šä¼ '];
  const st = isKnown ? statuses[Math.floor(Math.random()*2)] : 'æœªä¸Šä¼ ';
  const stClass = st==='æˆåŠŸ'?'badge-green':st==='å¤±è´¥'?'badge-red':'badge-gray';
  document.getElementById('uploadQueryResult').innerHTML = `
    <div style="font-size:14px; line-height:2.2;">
      <div>å›ç ï¼š<span style="color:#2563EB; font-size:16px; font-weight:700;">${code}</span></div>
      <div>çŠ¶æ€ï¼š<span class="badge ${stClass}">${st}</span></div>
      <div>ä¸Šä¼ æ—¶é—´ï¼š${st!=='æœªä¸Šä¼ ' ? '2024-12-01 14:35:20' : 'â€”'}</div>
      <div>ç®±æ•°ï¼š70</div>
      <div>å¤±è´¥åŸå› ï¼š${st==='å¤±è´¥' ? 'ç½‘ç»œè¶…æ—¶' : 'â€”'}</div>
    </div>
  `;
}

function setNotUploaded() {
  const code = document.getElementById('uploadQueryCode').value.trim();
  if(!code) { alert('è¯·è¾“å…¥å›ç '); return; }
  if(confirm(`ç¡®è®¤å°†å›ç  ${code} çš„çŠ¶æ€é‡ç½®ä¸ºæœªä¸Šä¼ ï¼Ÿ`)) {
    alert(`å›ç  ${code} å·²é‡ç½®ä¸ºæœªä¸Šä¼ çŠ¶æ€`);
    queryUploadStatus();
  }
}

function setUploaded() {
  const code = document.getElementById('uploadQueryCode').value.trim();
  if(!code) { alert('è¯·è¾“å…¥å›ç '); return; }
  if(confirm(`ç¡®è®¤å°†å›ç  ${code} æ ‡è®°ä¸ºå·²ä¸Šä¼ ï¼Ÿ`)) {
    alert(`å›ç  ${code} å·²æ ‡è®°ä¸ºå·²ä¸Šä¼ çŠ¶æ€`);
    queryUploadStatus();
  }
}

// å¯†ç éªŒè¯
function openSysSettings() {
  document.getElementById('pwdInput').value = '';
  document.getElementById('pwdError').textContent = '';
  document.getElementById('pwdOverlay').classList.add('active');
  setTimeout(() => document.getElementById('pwdInput').focus(), 100);
}

function closePwd() { document.getElementById('pwdOverlay').classList.remove('active'); }

function verifyPwd() {
  if(document.getElementById('pwdInput').value === '123456') {
    closePwd();
    document.getElementById('sysOverlay').classList.add('active');
  } else {
    document.getElementById('pwdError').textContent = 'å¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥';
    document.getElementById('pwdInput').value = '';
    document.getElementById('pwdInput').focus();
  }
}

function closeSys() { document.getElementById('sysOverlay').classList.remove('active'); }

function switchSysTab2(el, tabId) {
  document.querySelectorAll('.sys-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.sys-tab-panel').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  document.getElementById(tabId).classList.add('active');
}

// é€šç”¨ç¡®è®¤å¼¹çª—
let currentConfirmAction = null;
function closeConfirm() { document.getElementById('confirmOverlay').classList.remove('active'); }
function execConfirm() {
  if(document.getElementById('confirmPwd').value !== '123456') {
    document.getElementById('confirmPwdErr').textContent = 'å¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥';
    document.getElementById('confirmPwd').value = '';
    return;
  }
  closeConfirm();
  if(currentConfirmAction) currentConfirmAction();
}

function viewPackage(name) {
  document.getElementById('packageModalTitle').textContent = `æŸ¥çœ‹ç åŒ…ï¼š${name}`;
  const tbody = document.getElementById('packageTableBody');
  const codes = Array.from({length:10}, (_,i) => `20241201${String(1000+i).padStart(6,'0')}`);
  tbody.innerHTML = codes.map((c,i) => `<tr ${i%2?'class="row-even"':''}><td>${i+1}</td><td>${c}</td><td>2024-12-01 10:00:0${i}</td></tr>`).join('');
  document.getElementById('packageOverlay').classList.add('active');
}
function closePackage() { document.getElementById('packageOverlay').classList.remove('active'); }

function testDbConn2() {
  const result = document.getElementById('dbTestResult2');
  result.textContent = 'æ­£åœ¨è¿æ¥...'; result.style.color = '#6B7280';
  setTimeout(() => { result.textContent = 'âœ“ è¿æ¥æˆåŠŸ'; result.style.color = '#16A34A'; }, 1200);
}

// å¸®åŠ©å¼¹çª—
function showHelp(title, content) {
  const popup = document.getElementById('helpPopup');
  popup.innerHTML = `<strong style="display:block; margin-bottom:8px; color:#1F2937;">${title}</strong><div style="white-space:pre-line; font-size:13px; color:#374151; line-height:1.7;">${content}</div>`;
  popup.style.top = '50%'; popup.style.left = '50%';
  popup.style.transform = 'translate(-50%, -50%)';
  popup.style.position = 'fixed';
  popup.classList.add('show');
  setTimeout(() => document.addEventListener('click', hideHelp, {once:true}), 100);
}
function hideHelp() { document.getElementById('helpPopup').classList.remove('show'); }

function confirmExit() { if(confirm('ç¡®è®¤é€€å‡ºç³»ç»Ÿï¼Ÿ')) window.close(); }

// â”€â”€ æ“ä½œå¸®åŠ©å¼¹çª— â”€â”€
function openHelpModal() {
  const overlay = document.getElementById('helpOverlay');
  overlay.classList.add('active');
  // æ»šåŠ¨åˆ°é¡¶éƒ¨
  document.getElementById('helpContent').scrollTop = 0;
  // æ¿€æ´»ç¬¬ä¸€ä¸ªç›®å½•é¡¹
  updateHelpToc('h-intro');
  // ç›‘å¬æ­£æ–‡æ»šåŠ¨ â†’ æ›´æ–°ç›®å½•é«˜äº®
  document.getElementById('helpContent').addEventListener('scroll', onHelpScroll);
}

function closeHelpModal() {
  document.getElementById('helpOverlay').classList.remove('active');
  document.getElementById('helpContent').removeEventListener('scroll', onHelpScroll);
}

function scrollHelpTo(id) {
  const el = document.getElementById(id);
  if(!el) return;
  const content = document.getElementById('helpContent');
  content.scrollTo({ top: el.offsetTop - 16, behavior: 'smooth' });
  updateHelpToc(id);
}

function updateHelpToc(activeId) {
  document.querySelectorAll('.help-toc-item, .help-toc-sub').forEach(el => {
    el.classList.remove('active');
  });
  // æ‰¾åˆ°å¯¹åº”ç›®å½•é¡¹ï¼ˆé€šè¿‡ onclick å±æ€§åŒ¹é…ï¼‰
  document.querySelectorAll('.help-toc-item, .help-toc-sub').forEach(el => {
    if(el.getAttribute('onclick') && el.getAttribute('onclick').includes(activeId)) {
      el.classList.add('active');
    }
  });
}

const helpSectionIds = ['h-intro','h-m1','h-m2','h-funcs','h-manual','h-package','h-query','h-replace','h-cancel','h-stats','h-upload','h-faq','h-notes'];
function onHelpScroll() {
  const content = document.getElementById('helpContent');
  const scrollTop = content.scrollTop + 60;
  let current = helpSectionIds[0];
  helpSectionIds.forEach(id => {
    const el = document.getElementById(id);
    if(el && el.offsetTop <= scrollTop) current = id;
  });
  updateHelpToc(current);
}

// ESCå…³é—­
document.addEventListener('keydown', e => {
  if(e.key === 'Escape') {
    closePwd(); closeSys(); closeConfirm(); closePackage(); closePalletList();
    closeHelpModal();
    document.getElementById('helpPopup').classList.remove('show');
  }
});
</script>
</body>
</html>
